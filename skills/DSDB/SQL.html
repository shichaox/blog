<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SQL | 琅玕的博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="个人编程技术分享">
    
    <link rel="preload" href="/blog/assets/css/0.styles.671fbdd0.css" as="style"><link rel="preload" href="/blog/assets/js/app.e95f8842.js" as="script"><link rel="preload" href="/blog/assets/js/3.08356745.js" as="script"><link rel="preload" href="/blog/assets/js/38.1cfbe263.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.acf34bf9.js"><link rel="prefetch" href="/blog/assets/js/11.fef1fa27.js"><link rel="prefetch" href="/blog/assets/js/12.c774ebf1.js"><link rel="prefetch" href="/blog/assets/js/13.bf6af2da.js"><link rel="prefetch" href="/blog/assets/js/14.7b60b543.js"><link rel="prefetch" href="/blog/assets/js/15.5515032c.js"><link rel="prefetch" href="/blog/assets/js/16.3c0cd04c.js"><link rel="prefetch" href="/blog/assets/js/17.80206c1e.js"><link rel="prefetch" href="/blog/assets/js/18.e5e2c85c.js"><link rel="prefetch" href="/blog/assets/js/19.2f69b079.js"><link rel="prefetch" href="/blog/assets/js/2.9988781b.js"><link rel="prefetch" href="/blog/assets/js/20.7a923a3b.js"><link rel="prefetch" href="/blog/assets/js/21.d81d0001.js"><link rel="prefetch" href="/blog/assets/js/22.2fe5ab39.js"><link rel="prefetch" href="/blog/assets/js/23.99bc8ff5.js"><link rel="prefetch" href="/blog/assets/js/24.1fcf63f7.js"><link rel="prefetch" href="/blog/assets/js/25.a5536fa6.js"><link rel="prefetch" href="/blog/assets/js/26.e2fb222c.js"><link rel="prefetch" href="/blog/assets/js/27.03389df0.js"><link rel="prefetch" href="/blog/assets/js/28.4b72525f.js"><link rel="prefetch" href="/blog/assets/js/29.03a090ad.js"><link rel="prefetch" href="/blog/assets/js/30.87f31b47.js"><link rel="prefetch" href="/blog/assets/js/31.c639ea6f.js"><link rel="prefetch" href="/blog/assets/js/32.795ca246.js"><link rel="prefetch" href="/blog/assets/js/33.647699a4.js"><link rel="prefetch" href="/blog/assets/js/34.2909ac9c.js"><link rel="prefetch" href="/blog/assets/js/35.b5d4b577.js"><link rel="prefetch" href="/blog/assets/js/36.474a6bcb.js"><link rel="prefetch" href="/blog/assets/js/37.4590b450.js"><link rel="prefetch" href="/blog/assets/js/39.4c159456.js"><link rel="prefetch" href="/blog/assets/js/4.1c4b8134.js"><link rel="prefetch" href="/blog/assets/js/40.c52cb9af.js"><link rel="prefetch" href="/blog/assets/js/41.f77d6a1f.js"><link rel="prefetch" href="/blog/assets/js/42.c45631ae.js"><link rel="prefetch" href="/blog/assets/js/43.44644811.js"><link rel="prefetch" href="/blog/assets/js/44.c40d24aa.js"><link rel="prefetch" href="/blog/assets/js/45.0c1b86d7.js"><link rel="prefetch" href="/blog/assets/js/46.85dd5346.js"><link rel="prefetch" href="/blog/assets/js/47.a52d8379.js"><link rel="prefetch" href="/blog/assets/js/48.dfaedde6.js"><link rel="prefetch" href="/blog/assets/js/49.604893e5.js"><link rel="prefetch" href="/blog/assets/js/5.b41d7dd5.js"><link rel="prefetch" href="/blog/assets/js/50.228c7e1a.js"><link rel="prefetch" href="/blog/assets/js/51.7a95ac4e.js"><link rel="prefetch" href="/blog/assets/js/52.79ff7d2e.js"><link rel="prefetch" href="/blog/assets/js/53.7aeffa50.js"><link rel="prefetch" href="/blog/assets/js/54.c7097067.js"><link rel="prefetch" href="/blog/assets/js/6.31dc016b.js"><link rel="prefetch" href="/blog/assets/js/7.96c397d1.js"><link rel="prefetch" href="/blog/assets/js/8.e97d6841.js"><link rel="prefetch" href="/blog/assets/js/9.66ed6f07.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.671fbdd0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">琅玕的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  学习
</a></div><div class="nav-item"><a href="/blog/share/" class="nav-link">
  资源分享
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  学习
</a></div><div class="nav-item"><a href="/blog/share/" class="nav-link">
  资源分享
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/blog/skills/IoT" class="sidebar-heading clickable"><span>IoT</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/IoT/基于NodeMcu的智慧生态农业系统设计.html" class="sidebar-link">基于NodeMcu的智慧生态农业系统设计</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/JavaSE" class="sidebar-heading clickable"><span>JavaSE</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/JavaSE/File类和IO流.html" class="sidebar-link">File类和IO流</a></li><li><a href="/blog/skills/JavaSE/Java基础手写笔记.html" class="sidebar-link">/skills/JavaSE/Java基础手写笔记.html</a></li><li><a href="/blog/skills/JavaSE/Java常用API.html" class="sidebar-link">Java常用API</a></li><li><a href="/blog/skills/JavaSE/Thread.html" class="sidebar-link">Thread</a></li><li><a href="/blog/skills/JavaSE/内部类.html" class="sidebar-link">内部类</a></li><li><a href="/blog/skills/JavaSE/反射.html" class="sidebar-link">反射</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/DSDB" class="sidebar-heading clickable router-link-active open"><span>DSDB</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/DSDB/Collection.html" class="sidebar-link">Java的集合类</a></li><li><a href="/blog/skills/DSDB/HTTP&amp;Tomcat.html" class="sidebar-link">HTTP&amp;Tomcat</a></li><li><a href="/blog/skills/DSDB/JDBC.html" class="sidebar-link">JDBC</a></li><li><a href="/blog/skills/DSDB/Map.html" class="sidebar-link">Map</a></li><li><a href="/blog/skills/DSDB/Maven.html" class="sidebar-link">Maven</a></li><li><a href="/blog/skills/DSDB/Mybatis.html" class="sidebar-link">Mybatis</a></li><li><a href="/blog/skills/DSDB/SQL.html" aria-current="page" class="active sidebar-link">SQL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#数据库分类" class="sidebar-link">数据库分类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#关系型数据库" class="sidebar-link">关系型数据库</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#非关系型数据库" class="sidebar-link">非关系型数据库</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#group-by-分组" class="sidebar-link">group by(分组)</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#聚合函数" class="sidebar-link">聚合函数</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#having-和-where的区别" class="sidebar-link">having 和 where的区别</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#数据完整性" class="sidebar-link">数据完整性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#auto-increment自动增长约束" class="sidebar-link">auto_increment自动增长约束</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#数据库设计三大范式" class="sidebar-link">数据库设计三大范式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#第一范式" class="sidebar-link">第一范式</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#第二范式" class="sidebar-link">第二范式</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#第三范式" class="sidebar-link">第三范式</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/SQL.html#题目" class="sidebar-link">题目</a></li></ul></li><li><a href="/blog/skills/DSDB/Stream.html" class="sidebar-link">Stream</a></li><li><a href="/blog/skills/DSDB/前端.html" class="sidebar-link">前端</a></li><li><a href="/blog/skills/DSDB/数据库索引.html" class="sidebar-link">数据库索引</a></li><li><a href="/blog/skills/DSDB/连接池.html" class="sidebar-link">/skills/DSDB/连接池.html</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/JavaEE&amp;Spring" class="sidebar-heading clickable"><span>JavaEE&amp;Spring</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/JavaEE&amp;Spring/MyBatis-Spring.html" class="sidebar-link">MyBatis - Spring、Spring事务</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/Request&amp;Response.html" class="sidebar-link">Request &amp; Response</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/Servlet.html" class="sidebar-link">Servlet</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringAOP.html" class="sidebar-link">Spring AOP</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringBoot.html" class="sidebar-link">SpringBoot</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringIOC.html" class="sidebar-link">Spring IOC</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringMVC.html" class="sidebar-link">Spring MVC</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/设计模式.html" class="sidebar-link">设计模式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/微服务" class="sidebar-heading clickable"><span>微服务</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/微服务/ElasticSearch.html" class="sidebar-link">ElasticSearch</a></li><li><a href="/blog/skills/微服务/Gateway.html" class="sidebar-link">Gateway</a></li><li><a href="/blog/skills/微服务/MapStruct.html" class="sidebar-link">MapStruct</a></li><li><a href="/blog/skills/微服务/Mybatis-Plus.html" class="sidebar-link">Mybatis-Plus</a></li><li><a href="/blog/skills/微服务/Nginx.html" class="sidebar-link">Nginx</a></li><li><a href="/blog/skills/微服务/Redis.html" class="sidebar-link">Redis</a></li><li><a href="/blog/skills/微服务/Redis在Java项目中的使用.html" class="sidebar-link">Redis在Java项目中的使用</a></li><li><a href="/blog/skills/微服务/RocketMQ.html" class="sidebar-link">RocketMQ</a></li><li><a href="/blog/skills/微服务/SpringCloud.html" class="sidebar-link">SpringCloud</a></li><li><a href="/blog/skills/微服务/微服务.html" class="sidebar-link">微服务</a></li><li><a href="/blog/skills/微服务/微服务架构和单体架构.html" class="sidebar-link">微服务架构和单体架构</a></li><li><a href="/blog/skills/微服务/秒杀.html" class="sidebar-link">秒杀</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/面试" class="sidebar-heading clickable"><span>面试</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/面试/面经.html" class="sidebar-link">面经</a></li><li><a href="/blog/skills/面试/面试准备.html" class="sidebar-link">面试准备</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sql"><a href="#sql" class="header-anchor">#</a> SQL</h1> <h2 id="数据库分类"><a href="#数据库分类" class="header-anchor">#</a> 数据库分类</h2> <h3 id="关系型数据库"><a href="#关系型数据库" class="header-anchor">#</a> 关系型数据库</h3> <h3 id="非关系型数据库"><a href="#非关系型数据库" class="header-anchor">#</a> 非关系型数据库</h3> <p>默认当前时间：<code>current_timestamp</code></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">user</span>
	<span class="token punctuation">(</span>id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
	name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	password <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	create_time <span class="token keyword">timestamp</span> <span class="token keyword">default</span> <span class="token keyword">current_timestamp</span><span class="token punctuation">,</span>
	update_time <span class="token keyword">timestamp</span> <span class="token keyword">default</span> <span class="token keyword">current_timestamp</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">current_timestamp</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>create table user
-&gt; (id int primary key auto_increment,
-&gt; name varchar(255),
-&gt; password varchar(255),
-&gt; create_time timestamp default current_timestamp,
-&gt; update_time timestamp default current_timestamp on update current_timestamp</p> <h2 id="group-by-分组"><a href="#group-by-分组" class="header-anchor">#</a> group by(分组)</h2> <p>将整个表按照某个、某些字段分组，一般搭配聚合函数使用，可以计算分组内某个字段的非null的个数（或该分组的记录个数）、某个字段的和、某个字段的平均值、某个字段的最大值、最小值。</p> <p>例如：有一个学生信息表，将他们按班级分组</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> student<span class="token punctuation">(</span>   
id <span class="token keyword">int</span><span class="token punctuation">,</span>
name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
class <span class="token keyword">int</span><span class="token punctuation">,</span>
chinese <span class="token keyword">float</span><span class="token punctuation">,</span>
english <span class="token keyword">float</span><span class="token punctuation">,</span>
math <span class="token keyword">float</span>
<span class="token punctuation">)</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 计算每个班级学生人数</span>
<span class="token keyword">select</span> class<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> student_num <span class="token keyword">from</span> student <span class="token keyword">group</span> <span class="token keyword">by</span> class<span class="token punctuation">;</span>

<span class="token comment">-- 按班级分组，计算每一个班级语文大于80的人数</span>
<span class="token keyword">select</span> class<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> student <span class="token keyword">where</span> chinese <span class="token operator">&gt;</span> <span class="token number">80</span> <span class="token keyword">group</span> <span class="token keyword">by</span> class<span class="token punctuation">;</span>

<span class="token comment">-- 按班级分组，计算每个班级各个科目的平均成绩</span>
<span class="token keyword">select</span> class<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>chinese<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>english<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>math<span class="token punctuation">)</span> <span class="token keyword">from</span> student <span class="token keyword">group</span> <span class="token keyword">by</span> class<span class="token punctuation">;</span>

<span class="token comment">-- 按班级分组，计算每个班级各个科目的最大成绩</span>
<span class="token keyword">select</span> class<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>chinese<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>english<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>math<span class="token punctuation">)</span> <span class="token keyword">from</span> student <span class="token keyword">group</span> <span class="token keyword">by</span> class<span class="token punctuation">;</span>
</code></pre></div><p>group_concat(字段名)：将每个分组的指定字段的字段值都拼接起来。</p> <h2 id="聚合函数"><a href="#聚合函数" class="header-anchor">#</a> 聚合函数</h2> <table><thead><tr><th style="text-align:center;">函数</th> <th style="text-align:center;">COUNT</th> <th style="text-align:center;">SUM</th> <th style="text-align:center;">AVG</th> <th style="text-align:center;">MAX</th> <th style="text-align:center;">MIN</th></tr></thead> <tbody><tr><td style="text-align:center;">作用</td> <td style="text-align:center;">计数</td> <td style="text-align:center;">求和</td> <td style="text-align:center;">求平均值</td> <td style="text-align:center;">求最大值</td> <td style="text-align:center;">求最小值</td></tr></tbody></table> <h2 id="having-和-where的区别"><a href="#having-和-where的区别" class="header-anchor">#</a> having 和 where的区别</h2> <p>where主要用于对原始数据进行过滤；having主要对分组后的各个小组进行过滤，一般搭配聚合函数使用。</p> <p>where的作用对象主要是原始数据，用于确定保留哪些原始数据表项；having的作用对象是分组后的每一个小组，用于确定保留哪些组。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 按班级分组，统计每个班级的人数，查询人数大于30的班级的人数，并按班级人数从大到小排序。其中count(*) as num 是起别名。</span>
<span class="token keyword">select</span> class<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num <span class="token keyword">from</span> student <span class="token keyword">group</span> <span class="token keyword">by</span> class <span class="token keyword">having</span> num <span class="token operator">&gt;</span> <span class="token number">30</span> <span class="token keyword">order</span> <span class="token keyword">by</span> num <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre></div><p>between and</p> <p>in</p> <h2 id="数据完整性"><a href="#数据完整性" class="header-anchor">#</a> 数据完整性</h2> <h3 id="auto-increment自动增长约束"><a href="#auto-increment自动增长约束" class="header-anchor">#</a> auto_increment自动增长约束</h3> <p>什么情况下，auto_increment自动生成的序号会不连续？</p> <p>在有其他唯一性约束的时候。</p> <h2 id="数据库设计三大范式"><a href="#数据库设计三大范式" class="header-anchor">#</a> 数据库设计三大范式</h2> <h3 id="第一范式"><a href="#第一范式" class="header-anchor">#</a> 第一范式</h3> <h3 id="第二范式"><a href="#第二范式" class="header-anchor">#</a> 第二范式</h3> <h3 id="第三范式"><a href="#第三范式" class="header-anchor">#</a> 第三范式</h3> <h2 id="题目"><a href="#题目" class="header-anchor">#</a> 题目</h2> <ol><li>在数据库中创建如下两张表</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> dept 
<span class="token punctuation">(</span> 
deptno <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span> 
dname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> 
<span class="token punctuation">)</span><span class="token punctuation">;</span> 


<span class="token keyword">create</span> <span class="token keyword">table</span> emp 
<span class="token punctuation">(</span> 
empno <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span> 
ename <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
mgr <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
sal <span class="token keyword">float</span><span class="token punctuation">,</span> 
deptno <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">references</span> dept<span class="token punctuation">(</span>deptno<span class="token punctuation">)</span> 
<span class="token punctuation">)</span><span class="token punctuation">;</span> 

 
<span class="token keyword">insert</span> <span class="token keyword">into</span> dept <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'事业部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> dept <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span><span class="token string">'销售部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> dept <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">,</span><span class="token string">'技术部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
 
<span class="token keyword">insert</span> <span class="token keyword">into</span> emp <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span><span class="token string">'jacky'</span><span class="token punctuation">,</span><span class="token string">'clerk'</span><span class="token punctuation">,</span><span class="token string">'tom'</span><span class="token punctuation">,</span><span class="token string">'1000'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> emp <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'02'</span><span class="token punctuation">,</span><span class="token string">'tom'</span><span class="token punctuation">,</span><span class="token string">'clerk'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'2000'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> emp <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'07'</span><span class="token punctuation">,</span><span class="token string">'biddy'</span><span class="token punctuation">,</span><span class="token string">'clerk'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'2000'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> emp <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'03'</span><span class="token punctuation">,</span><span class="token string">'jenny'</span><span class="token punctuation">,</span><span class="token string">'sales'</span><span class="token punctuation">,</span><span class="token string">'pretty'</span><span class="token punctuation">,</span><span class="token string">'600'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> emp <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'04'</span><span class="token punctuation">,</span><span class="token string">'pretty'</span><span class="token punctuation">,</span><span class="token string">'sales'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'800'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> emp <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'05'</span><span class="token punctuation">,</span><span class="token string">'buddy'</span><span class="token punctuation">,</span><span class="token string">'jishu'</span><span class="token punctuation">,</span><span class="token string">'canndy'</span><span class="token punctuation">,</span><span class="token string">'1000'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> emp <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'06'</span><span class="token punctuation">,</span><span class="token string">'canndy'</span><span class="token punctuation">,</span><span class="token string">'jishu'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'1500'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept<span class="token punctuation">;</span> 
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--1列出emp表中各部门的部门号，最高工资，最低工资</span>
<span class="token keyword">select</span> deptno<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> deptno<span class="token punctuation">;</span>

<span class="token comment">--2 列出emp表中各部门job为'CLERK'的员工的最低工资，最高工资</span>
<span class="token keyword">select</span> deptno<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'CLERK'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> deptno<span class="token punctuation">;</span>

<span class="token comment">--3 对于emp中最低工资小于2000的部门，列出job为'CLERK'的员工的部门号，最低工资，最高工资 </span>
<span class="token number">3.</span>错误，<span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span>有问题
<span class="token keyword">select</span> deptno<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span><span class="token string">'CLERK'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> deptno <span class="token keyword">having</span> <span class="token function">min</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2000</span><span class="token punctuation">;</span>

<span class="token comment">--4 根据部门号由高而低，工资有低而高列出每个员工的姓名，部门号，工资</span>
<span class="token keyword">select</span> ename<span class="token punctuation">,</span> deptno<span class="token punctuation">,</span> sal <span class="token keyword">from</span> emp <span class="token keyword">order</span> <span class="token keyword">by</span> deptno <span class="token keyword">desc</span><span class="token punctuation">,</span> sal <span class="token keyword">asc</span><span class="token punctuation">;</span>

<span class="token comment">--5 列出'buddy'所在部门中每个员工的姓名与部门号</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> deptno <span class="token keyword">from</span> emp <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'buddy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">--6 列出每个员工的姓名，工作，部门号，部门名</span>
<span class="token keyword">select</span> emp<span class="token punctuation">.</span>ename<span class="token punctuation">,</span> emp<span class="token punctuation">.</span>job<span class="token punctuation">,</span> emp<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span> dept<span class="token punctuation">.</span>dname <span class="token keyword">from</span> dept
<span class="token keyword">inner</span> <span class="token keyword">join</span> emp
<span class="token keyword">on</span> dept<span class="token punctuation">.</span>deptno <span class="token operator">=</span> emp<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span>

<span class="token comment">--7列出emp中工作为'CLERK'的员工的姓名，工作，部门号，部门名</span>
<span class="token keyword">select</span> emp<span class="token punctuation">.</span>ename<span class="token punctuation">,</span> emp<span class="token punctuation">.</span>job<span class="token punctuation">,</span> emp<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span> dept<span class="token punctuation">.</span>dname <span class="token keyword">from</span> dept
<span class="token keyword">inner</span> <span class="token keyword">join</span> emp
<span class="token keyword">on</span> dept<span class="token punctuation">.</span>deptno <span class="token operator">=</span> emp<span class="token punctuation">.</span>deptno
<span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'CLERK'</span><span class="token punctuation">;</span>

<span class="token comment">--8 对于emp中有管理者的员工，列出姓名，管理者姓名（管理者外键为mgr）</span>
<span class="token keyword">select</span> ename<span class="token punctuation">,</span> mgr <span class="token keyword">from</span> emp <span class="token keyword">where</span> mgr <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">;</span>

<span class="token comment">--9 对于dept表中，列出所有部门名，部门号，同时列出各部门工作为'CLERK'的员工名与工作</span>
<span class="token keyword">select</span> dept<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span> dept<span class="token punctuation">.</span>dname<span class="token punctuation">,</span> e<span class="token punctuation">.</span>ename<span class="token punctuation">,</span> e<span class="token punctuation">.</span>job <span class="token keyword">from</span> dept
<span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> job <span class="token operator">=</span> <span class="token string">'CLERK'</span><span class="token punctuation">)</span> e
<span class="token keyword">on</span> dept<span class="token punctuation">.</span>deptno <span class="token operator">=</span> e<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span>

<span class="token comment">--10 对于工资高于本部门平均水平的员工，列出部门号，姓名，工资，按部门号排序</span>
<span class="token keyword">select</span> emp<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span> emp<span class="token punctuation">.</span>ename<span class="token punctuation">,</span> emp<span class="token punctuation">.</span>sal <span class="token keyword">from</span> 
<span class="token punctuation">(</span><span class="token keyword">select</span> deptno<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_sal <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> deptno<span class="token punctuation">)</span> average
<span class="token keyword">inner</span> <span class="token keyword">join</span> emp
<span class="token keyword">on</span> average<span class="token punctuation">.</span>deptno <span class="token operator">=</span> emp<span class="token punctuation">.</span>deptno
<span class="token keyword">where</span> emp<span class="token punctuation">.</span>sal <span class="token operator">&gt;</span> average<span class="token punctuation">.</span>avg_sal
<span class="token keyword">order</span> <span class="token keyword">by</span> emp<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span>

<span class="token comment">--11 对于emp，列出各个部门中工资高于本部门平均工资的员工数和部门号，按部门号排序</span>
<span class="token keyword">select</span> emp<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> 
<span class="token punctuation">(</span><span class="token keyword">select</span> deptno<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_sal <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> deptno<span class="token punctuation">)</span> average
<span class="token keyword">inner</span> <span class="token keyword">join</span> emp
<span class="token keyword">on</span> average<span class="token punctuation">.</span>deptno <span class="token operator">=</span> emp<span class="token punctuation">.</span>deptno
<span class="token keyword">where</span> emp<span class="token punctuation">.</span>sal <span class="token operator">&gt;</span> average<span class="token punctuation">.</span>avg_sal
<span class="token keyword">group</span> <span class="token keyword">by</span> emp<span class="token punctuation">.</span>deptno
<span class="token keyword">order</span> <span class="token keyword">by</span> emp<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>某大学研究生院有若干研究生导师，包括职工编号、姓名、职称、研究方向，其中每个导师的职工编号是唯一的。
若干研究生，包括学号、姓名、性别、入学日期，其中每个研究生的学号是唯一的。
每个导师可以带若干研究生，但每个研究生只能有一个导师。
请设计一个数据库，要求可以正确体现导师和研究生之间的关系。
设计完毕之后，请插入一定量的数据，并验证你设计的数据库是否满足要求。</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 一对多</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> teacher<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    direction <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> student<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    gender <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    enrollment_date <span class="token keyword">date</span><span class="token punctuation">,</span>
    teacher_id <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token keyword">level</span><span class="token punctuation">,</span> direction<span class="token punctuation">)</span> <span class="token keyword">values</span>
<span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'教授'</span><span class="token punctuation">,</span> <span class="token string">'计算机科学'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token string">'副教授'</span><span class="token punctuation">,</span> <span class="token string">'软件工程'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'王二'</span><span class="token punctuation">,</span> <span class="token string">'副教授'</span><span class="token punctuation">,</span> <span class="token string">'计算机科学'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'马七'</span><span class="token punctuation">,</span> <span class="token string">'副教授'</span><span class="token punctuation">,</span> <span class="token string">'软件工程'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'王五'</span><span class="token punctuation">,</span> <span class="token string">'教授'</span><span class="token punctuation">,</span> <span class="token string">'大数据'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'马六'</span><span class="token punctuation">,</span> <span class="token string">'教授'</span><span class="token punctuation">,</span> <span class="token string">'物联网工程'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> student <span class="token punctuation">(</span>name<span class="token punctuation">,</span> gender<span class="token punctuation">,</span> enrollment_date<span class="token punctuation">,</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">values</span>
<span class="token punctuation">(</span><span class="token string">'孙悟空'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'2020-09-01'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'牛魔王'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'2020-09-01'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'铁扇公主'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'2020-09-01'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'猪八戒'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'2019-09-01'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'沙和尚'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'2019-09-01'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'白龙马'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'2018-09-01'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'白骨精'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'2017-09-01'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'红孩儿'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 1.请查出每个导师所带研究生的姓名。</span>
<span class="token keyword">select</span> t<span class="token punctuation">.</span>name<span class="token punctuation">,</span> group_concat<span class="token punctuation">(</span>s<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token keyword">from</span> teacher t
<span class="token keyword">inner</span> <span class="token keyword">join</span> student s
<span class="token keyword">on</span> t<span class="token punctuation">.</span>id <span class="token operator">=</span> s<span class="token punctuation">.</span>teacher_id
<span class="token keyword">group</span> <span class="token keyword">by</span> t<span class="token punctuation">.</span>name<span class="token punctuation">;</span>

<span class="token comment">-- 2.清查出特定姓名的导师所带研究生的姓名。</span>
<span class="token keyword">select</span> t<span class="token punctuation">.</span>name<span class="token punctuation">,</span> group_concat<span class="token punctuation">(</span>s<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token keyword">from</span> teacher t
<span class="token keyword">inner</span> <span class="token keyword">join</span> student s
<span class="token keyword">on</span> t<span class="token punctuation">.</span>id <span class="token operator">=</span> s<span class="token punctuation">.</span>teacher_id
<span class="token keyword">group</span> <span class="token keyword">by</span> t<span class="token punctuation">.</span>name
<span class="token keyword">having</span> t<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>

<span class="token comment">-- 3.请查出每个导师所带研究生的数量。</span>
<span class="token keyword">select</span> t<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> student_number <span class="token keyword">from</span> teacher t
<span class="token keyword">inner</span> <span class="token keyword">join</span> student s
<span class="token keyword">on</span> t<span class="token punctuation">.</span>id <span class="token operator">=</span> teacher_id
<span class="token keyword">group</span> <span class="token keyword">by</span> t<span class="token punctuation">.</span>name<span class="token punctuation">;</span>

<span class="token comment">-- 4.请查出每个导师所带的男研究生的数量。</span>
<span class="token keyword">select</span> t<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> student_number <span class="token keyword">from</span> teacher t
<span class="token keyword">inner</span> <span class="token keyword">join</span> student s
<span class="token keyword">on</span> t<span class="token punctuation">.</span>id <span class="token operator">=</span> teacher_id
<span class="token keyword">where</span> gender <span class="token operator">=</span> <span class="token string">'男'</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> t<span class="token punctuation">.</span>name <span class="token punctuation">;</span>

<span class="token comment">-- 5.请找出选择哪个研究方向的导师最多。</span>
<span class="token keyword">select</span> direction<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>  <span class="token keyword">from</span> teacher <span class="token keyword">group</span> <span class="token keyword">by</span> direction <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">desc</span> <span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 6.请找统计不同职称的导师的个数。</span>
<span class="token keyword">select</span> <span class="token keyword">level</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num <span class="token keyword">from</span> teacher <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">level</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/skills/DSDB/Mybatis.html" class="prev">
        Mybatis
      </a></span> <span class="next"><a href="/blog/skills/DSDB/Stream.html">
        Stream
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.e95f8842.js" defer></script><script src="/blog/assets/js/3.08356745.js" defer></script><script src="/blog/assets/js/38.1cfbe263.js" defer></script>
  </body>
</html>
