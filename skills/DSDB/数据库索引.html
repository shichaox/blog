<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据库索引 | 琅玕的博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="个人编程技术分享">
    
    <link rel="preload" href="/blog/assets/css/0.styles.671fbdd0.css" as="style"><link rel="preload" href="/blog/assets/js/app.e95f8842.js" as="script"><link rel="preload" href="/blog/assets/js/3.08356745.js" as="script"><link rel="preload" href="/blog/assets/js/13.bf6af2da.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.acf34bf9.js"><link rel="prefetch" href="/blog/assets/js/11.fef1fa27.js"><link rel="prefetch" href="/blog/assets/js/12.c774ebf1.js"><link rel="prefetch" href="/blog/assets/js/14.7b60b543.js"><link rel="prefetch" href="/blog/assets/js/15.5515032c.js"><link rel="prefetch" href="/blog/assets/js/16.3c0cd04c.js"><link rel="prefetch" href="/blog/assets/js/17.80206c1e.js"><link rel="prefetch" href="/blog/assets/js/18.e5e2c85c.js"><link rel="prefetch" href="/blog/assets/js/19.2f69b079.js"><link rel="prefetch" href="/blog/assets/js/2.9988781b.js"><link rel="prefetch" href="/blog/assets/js/20.7a923a3b.js"><link rel="prefetch" href="/blog/assets/js/21.d81d0001.js"><link rel="prefetch" href="/blog/assets/js/22.2fe5ab39.js"><link rel="prefetch" href="/blog/assets/js/23.99bc8ff5.js"><link rel="prefetch" href="/blog/assets/js/24.1fcf63f7.js"><link rel="prefetch" href="/blog/assets/js/25.a5536fa6.js"><link rel="prefetch" href="/blog/assets/js/26.e2fb222c.js"><link rel="prefetch" href="/blog/assets/js/27.03389df0.js"><link rel="prefetch" href="/blog/assets/js/28.4b72525f.js"><link rel="prefetch" href="/blog/assets/js/29.03a090ad.js"><link rel="prefetch" href="/blog/assets/js/30.87f31b47.js"><link rel="prefetch" href="/blog/assets/js/31.c639ea6f.js"><link rel="prefetch" href="/blog/assets/js/32.795ca246.js"><link rel="prefetch" href="/blog/assets/js/33.647699a4.js"><link rel="prefetch" href="/blog/assets/js/34.2909ac9c.js"><link rel="prefetch" href="/blog/assets/js/35.b5d4b577.js"><link rel="prefetch" href="/blog/assets/js/36.474a6bcb.js"><link rel="prefetch" href="/blog/assets/js/37.4590b450.js"><link rel="prefetch" href="/blog/assets/js/38.1cfbe263.js"><link rel="prefetch" href="/blog/assets/js/39.4c159456.js"><link rel="prefetch" href="/blog/assets/js/4.1c4b8134.js"><link rel="prefetch" href="/blog/assets/js/40.c52cb9af.js"><link rel="prefetch" href="/blog/assets/js/41.f77d6a1f.js"><link rel="prefetch" href="/blog/assets/js/42.c45631ae.js"><link rel="prefetch" href="/blog/assets/js/43.44644811.js"><link rel="prefetch" href="/blog/assets/js/44.c40d24aa.js"><link rel="prefetch" href="/blog/assets/js/45.0c1b86d7.js"><link rel="prefetch" href="/blog/assets/js/46.85dd5346.js"><link rel="prefetch" href="/blog/assets/js/47.a52d8379.js"><link rel="prefetch" href="/blog/assets/js/48.dfaedde6.js"><link rel="prefetch" href="/blog/assets/js/49.604893e5.js"><link rel="prefetch" href="/blog/assets/js/5.b41d7dd5.js"><link rel="prefetch" href="/blog/assets/js/50.228c7e1a.js"><link rel="prefetch" href="/blog/assets/js/51.7a95ac4e.js"><link rel="prefetch" href="/blog/assets/js/52.79ff7d2e.js"><link rel="prefetch" href="/blog/assets/js/53.7aeffa50.js"><link rel="prefetch" href="/blog/assets/js/54.c7097067.js"><link rel="prefetch" href="/blog/assets/js/6.31dc016b.js"><link rel="prefetch" href="/blog/assets/js/7.96c397d1.js"><link rel="prefetch" href="/blog/assets/js/8.e97d6841.js"><link rel="prefetch" href="/blog/assets/js/9.66ed6f07.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.671fbdd0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">琅玕的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  学习
</a></div><div class="nav-item"><a href="/blog/share/" class="nav-link">
  资源分享
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  学习
</a></div><div class="nav-item"><a href="/blog/share/" class="nav-link">
  资源分享
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/blog/skills/IoT" class="sidebar-heading clickable"><span>IoT</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/IoT/基于NodeMcu的智慧生态农业系统设计.html" class="sidebar-link">基于NodeMcu的智慧生态农业系统设计</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/JavaSE" class="sidebar-heading clickable"><span>JavaSE</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/JavaSE/File类和IO流.html" class="sidebar-link">File类和IO流</a></li><li><a href="/blog/skills/JavaSE/Java基础手写笔记.html" class="sidebar-link">/skills/JavaSE/Java基础手写笔记.html</a></li><li><a href="/blog/skills/JavaSE/Java常用API.html" class="sidebar-link">Java常用API</a></li><li><a href="/blog/skills/JavaSE/Thread.html" class="sidebar-link">Thread</a></li><li><a href="/blog/skills/JavaSE/内部类.html" class="sidebar-link">内部类</a></li><li><a href="/blog/skills/JavaSE/反射.html" class="sidebar-link">反射</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/DSDB" class="sidebar-heading clickable router-link-active open"><span>DSDB</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/DSDB/Collection.html" class="sidebar-link">Java的集合类</a></li><li><a href="/blog/skills/DSDB/HTTP&amp;Tomcat.html" class="sidebar-link">HTTP&amp;Tomcat</a></li><li><a href="/blog/skills/DSDB/JDBC.html" class="sidebar-link">JDBC</a></li><li><a href="/blog/skills/DSDB/Map.html" class="sidebar-link">Map</a></li><li><a href="/blog/skills/DSDB/Maven.html" class="sidebar-link">Maven</a></li><li><a href="/blog/skills/DSDB/Mybatis.html" class="sidebar-link">Mybatis</a></li><li><a href="/blog/skills/DSDB/SQL.html" class="sidebar-link">SQL</a></li><li><a href="/blog/skills/DSDB/Stream.html" class="sidebar-link">Stream</a></li><li><a href="/blog/skills/DSDB/前端.html" class="sidebar-link">前端</a></li><li><a href="/blog/skills/DSDB/数据库索引.html" class="active sidebar-link">数据库索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#索引" class="sidebar-link">索引</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#索引的优缺点" class="sidebar-link">索引的优缺点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#优点" class="sidebar-link">优点</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#缺点-索引对数据库的负面影响有哪些" class="sidebar-link">缺点（索引对数据库的负面影响有哪些？）</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#数据库中索引的分类" class="sidebar-link">数据库中索引的分类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#按功能划分" class="sidebar-link">按功能划分</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#按物理划分" class="sidebar-link">按物理划分</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#数据结构为什么采用b-树" class="sidebar-link">数据结构为什么采用B+树？</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#索引的实现" class="sidebar-link">索引的实现</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#myisam" class="sidebar-link">MyISAM</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#innodb" class="sidebar-link">InnoDB</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#聚集索引和非聚集索引" class="sidebar-link">聚集索引和非聚集索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#聚集索引" class="sidebar-link">聚集索引</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#非聚集索引" class="sidebar-link">非聚集索引</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#区别" class="sidebar-link">区别</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#聚集索引和主键索引的关系" class="sidebar-link">聚集索引和主键索引的关系</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/数据库索引.html#索引的语法" class="sidebar-link">索引的语法</a></li></ul></li><li><a href="/blog/skills/DSDB/连接池.html" class="sidebar-link">/skills/DSDB/连接池.html</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/JavaEE&amp;Spring" class="sidebar-heading clickable"><span>JavaEE&amp;Spring</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/JavaEE&amp;Spring/MyBatis-Spring.html" class="sidebar-link">MyBatis - Spring、Spring事务</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/Request&amp;Response.html" class="sidebar-link">Request &amp; Response</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/Servlet.html" class="sidebar-link">Servlet</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringAOP.html" class="sidebar-link">Spring AOP</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringBoot.html" class="sidebar-link">SpringBoot</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringIOC.html" class="sidebar-link">Spring IOC</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringMVC.html" class="sidebar-link">Spring MVC</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/设计模式.html" class="sidebar-link">设计模式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/微服务" class="sidebar-heading clickable"><span>微服务</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/微服务/ElasticSearch.html" class="sidebar-link">ElasticSearch</a></li><li><a href="/blog/skills/微服务/Gateway.html" class="sidebar-link">Gateway</a></li><li><a href="/blog/skills/微服务/MapStruct.html" class="sidebar-link">MapStruct</a></li><li><a href="/blog/skills/微服务/Mybatis-Plus.html" class="sidebar-link">Mybatis-Plus</a></li><li><a href="/blog/skills/微服务/Nginx.html" class="sidebar-link">Nginx</a></li><li><a href="/blog/skills/微服务/Redis.html" class="sidebar-link">Redis</a></li><li><a href="/blog/skills/微服务/Redis在Java项目中的使用.html" class="sidebar-link">Redis在Java项目中的使用</a></li><li><a href="/blog/skills/微服务/RocketMQ.html" class="sidebar-link">RocketMQ</a></li><li><a href="/blog/skills/微服务/SpringCloud.html" class="sidebar-link">SpringCloud</a></li><li><a href="/blog/skills/微服务/微服务.html" class="sidebar-link">微服务</a></li><li><a href="/blog/skills/微服务/微服务架构和单体架构.html" class="sidebar-link">微服务架构和单体架构</a></li><li><a href="/blog/skills/微服务/秒杀.html" class="sidebar-link">秒杀</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/面试" class="sidebar-heading clickable"><span>面试</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/面试/面经.html" class="sidebar-link">面经</a></li><li><a href="/blog/skills/面试/面试准备.html" class="sidebar-link">面试准备</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="数据库索引"><a href="#数据库索引" class="header-anchor">#</a> 数据库索引</h1> <h2 id="索引"><a href="#索引" class="header-anchor">#</a> 索引</h2> <p>索引是关系型数据库中对某一列或多个列的值进行排序的数据结构。通过索引可以快速访问数据库中的特定的信息，而不需要扫描整个数据库表。索引就像书籍中的目录，可以根据关键字快速定位到数据所在位置，从而加速查询操作。</p> <h2 id="索引的优缺点"><a href="#索引的优缺点" class="header-anchor">#</a> 索引的优缺点</h2> <h3 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h3> <ol><li>大大加快数据的查询速度。</li> <li>加快表的连接速度。</li></ol> <h3 id="缺点-索引对数据库的负面影响有哪些"><a href="#缺点-索引对数据库的负面影响有哪些" class="header-anchor">#</a> 缺点（索引对数据库的负面影响有哪些？）</h3> <ol><li>创建索引和维护索引需要耗费时间，耗费的时间随着数据量的增加而增加。</li> <li>索引需要占用物理空间。</li> <li>对表进行增删改查的时候，索引也要动态维护，随着数据的变化，索引结构也会发生变化，维护成本变大，增删改查效率降低。</li></ol> <h2 id="数据库中索引的分类"><a href="#数据库中索引的分类" class="header-anchor">#</a> 数据库中索引的分类</h2> <h3 id="按功能划分"><a href="#按功能划分" class="header-anchor">#</a> 按功能划分</h3> <p>(1) 主键索引</p> <p>(2) 唯一性索引</p> <p>(3) 全文索引</p> <p>(4) 普通索引</p> <h3 id="按物理划分"><a href="#按物理划分" class="header-anchor">#</a> 按物理划分</h3> <p>(1) 聚集索引</p> <p>(2) 非聚集索引</p> <h2 id="数据结构为什么采用b-树"><a href="#数据结构为什么采用b-树" class="header-anchor">#</a> 数据结构为什么采用B+树？</h2> <p>B+树：自平衡搜索树</p> <p>对于m阶B+树：</p> <ul><li><p>每个节点最多有m个子树</p></li> <li><p>根节点不是叶子结点时，最少有两颗子树</p></li> <li><p>除了根结点之外的非终端结点子树最少有
$$
\lceil m / 2 \rceil
$$</p></li> <li></li> <li><p>结点的关键字个数要求等于该结点对应子树个数要求 - 1 （非终端节点、非根节点为(m / 2)向上取整 - 1）</p></li> <li><p>B树结点的结构举例</p></li></ul> <table><thead><tr><th style="text-align:center;">指针</th> <th style="text-align:center;">关键字</th> <th style="text-align:center;">指针</th> <th style="text-align:center;">关键字</th> <th style="text-align:center;">指针</th></tr></thead> <tbody></tbody></table> <p>B+树与<strong>数组和链表</strong>比较：</p> <p>数组和链表要逐个比较所有数据，而B+树在每层只需要查找比较一个结点的数据。</p> <p>B+树与<strong>二叉树</strong>比较：</p> <p>二叉树存储密度低，当数据量增大时，树的高度会升高，这样查询的次数就会变多，速度变慢；与二叉树相比，树的高度变低，磁盘IO次数减少，查询速度增高。</p> <p>B+树与<strong>B树</strong>比较：</p> <p>(1) 与B树相比，B+树的所有非叶子结点只存储key，不存储data，会降低树的高度，进一步提高查询效率。</p> <p>(2) 所有数据都存储在叶子结点，叶子结点之间维护了一个指针，方便了范围查找。</p> <table><thead><tr><th style="text-align:center;"></th> <th style="text-align:center;">数组</th> <th style="text-align:center;">链表</th> <th style="text-align:center;">有序数组</th> <th style="text-align:center;">二叉树</th> <th style="text-align:center;">B树</th> <th style="text-align:center;">B+树</th></tr></thead> <tbody><tr><td style="text-align:center;">查找单个值</td> <td style="text-align:center;">速度慢，因为要比较所有的数据</td> <td style="text-align:center;">速度慢，因为要比较所有的数据</td> <td style="text-align:center;">速度快，采用二分法</td> <td style="text-align:center;">速度快</td> <td style="text-align:center;">速度快，比二叉树高度降低了，查询的效率也变高了</td> <td style="text-align:center;">方便</td></tr> <tr><td style="text-align:center;">查找范围值</td> <td style="text-align:center;">速度慢，因为要比较所有的数据</td> <td style="text-align:center;">速度慢，因为要比较所有的数据</td> <td style="text-align:center;">速度快，因为是有序的，可以先找到一个边界，然后顺着走。</td> <td style="text-align:center;">速度慢，因为要在父节点和字节点之间反复跳转</td> <td style="text-align:center;">需要在父子节点之间反复查找，不太方便</td> <td style="text-align:center;">方便，因为所有的数据都存储在叶子结点，叶子结点之间维护了一个指针，指向下一个叶子结点，并且叶子结点之间是有序的</td></tr> <tr><td style="text-align:center;">插入值</td> <td style="text-align:center;">速度快</td> <td style="text-align:center;">速度快</td> <td style="text-align:center;">速度慢，因为插入一条数据，需要挪动数据。</td> <td style="text-align:center;">速度快</td> <td style="text-align:center;">速度快</td> <td style="text-align:center;">方便</td></tr> <tr><td style="text-align:center;">缺点</td> <td style="text-align:center;"></td> <td style="text-align:center;"></td> <td style="text-align:center;"></td> <td style="text-align:center;">存储密度低，当数据量增大时，树的高度会升高，这样查询的次数就会变多，速度变慢</td> <td style="text-align:center;"></td> <td style="text-align:center;"></td></tr></tbody></table> <h2 id="索引的实现"><a href="#索引的实现" class="header-anchor">#</a> 索引的实现</h2> <p>MySQL数据的存储和存储引擎息息相关，不同的存储引擎存储数据的方式是不一样的。</p> <p>存储引擎：是将数据如何在磁盘中存储组织的技术，不同的技术（存储引擎）使用不同的存储机制，索引技巧、锁定级别等不同的功能和能力。</p> <p>MySQL底层的存储引擎作为一个插件存在。</p> <p>在MySQL中有很多存储引擎</p> <ul><li>InnoDB(5.1之后默认的存储引擎)</li> <li>MyISAM(5.1之前默认的存储引擎)，由MySQL官方团队开发。</li></ul> <p>InnoDB和MyISAM索引最大的的区别：MyISAM主键索引中，索引的数据部分是索引对应的数据的地址值，而InnoDB的主键索引中，索引的数据部分就是索引所在行的数据。</p> <table><thead><tr><th style="text-align:center;">区别</th> <th style="text-align:center;">MyISAM</th> <th style="text-align:center;">InnoDB</th></tr></thead> <tbody><tr><td style="text-align:center;">存储结构</td> <td style="text-align:center;">frm、MYD、MYI</td> <td style="text-align:center;">frm、ibd</td></tr> <tr><td style="text-align:center;">事务</td> <td style="text-align:center;">不支持</td> <td style="text-align:center;">支持</td></tr> <tr><td style="text-align:center;">外键</td> <td style="text-align:center;">不支持</td> <td style="text-align:center;">支持</td></tr> <tr><td style="text-align:center;">锁</td> <td style="text-align:center;">只支持表锁</td> <td style="text-align:center;">支持表锁和行锁</td></tr></tbody></table> <h3 id="myisam"><a href="#myisam" class="header-anchor">#</a> MyISAM</h3> <p>MyISAM表有三个文件</p> <ul><li><p>.frm(表结构定义文件)</p> <p>定义表的结构，表里面有哪些列，列的类型</p></li> <li><p>.MYD(数据文件)</p> <p>存储表的数据</p></li> <li><p>.MYI(索引文件)存储表的索引树</p></li></ul> <h4 id="myisam主键索引"><a href="#myisam主键索引" class="header-anchor">#</a> MyISAM主键索引</h4> <ul><li><p>key: 主键值</p></li> <li><p>data: 主键这一行数据对应的地址值</p></li></ul> <h4 id="myisam非主键索引"><a href="#myisam非主键索引" class="header-anchor">#</a> MyISAM非主键索引</h4> <ul><li>key: 索引列的值</li> <li>data: 索引列这一行数据对应的地址值</li></ul> <h3 id="innodb"><a href="#innodb" class="header-anchor">#</a> InnoDB</h3> <ul><li>.frm(表结构定义文件)</li> <li>.ibd(数据和索引文件)</li></ul> <h4 id="innodb主键索引"><a href="#innodb主键索引" class="header-anchor">#</a> InnoDB主键索引</h4> <p>key: 主键值</p> <p>data: 数据表的数据</p> <p>在InnoDB的主键索引中，索引和数据是存储在一起的，也就是说索引的数据部分就是数据表的数据。</p> <blockquote><p>在InnoDB中，数据是依附于主键索引来存储的，如果没有主键，那么就不存在主键索引树，数据也没有办法存储。所以对InnoDB来说必须有一个主键，如果用户在创建表格时，没有设置主键，那么</p></blockquote> <h4 id="innodb非主键索引"><a href="#innodb非主键索引" class="header-anchor">#</a> InnoDB非主键索引</h4> <p>key: 索引列的值</p> <p>data: 这行数据对应的主键值</p> <h4 id="innodb索引示例图解"><a href="#innodb索引示例图解" class="header-anchor">#</a> InnoDB索引示例图解</h4> <p>对于以下这个表</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>

 <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>

 <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

 <span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

 <span class="token identifier"><span class="token punctuation">`</span>age<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

 <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>

 <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>password_index<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>

 <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>username_index<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>

<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">10063003</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
</code></pre></div><p>有几个索引树？ 画出这个索引树具体的存储结构</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">user</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> age<span class="token punctuation">)</span> <span class="token keyword">values</span>
<span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token string">'123456'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'666666'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'tom'</span><span class="token punctuation">,</span> <span class="token string">'520520'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'jack'</span><span class="token punctuation">,</span> <span class="token string">'520666'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'tomcat'</span><span class="token punctuation">,</span> <span class="token string">'435566'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'allen'</span><span class="token punctuation">,</span> <span class="token string">'737366'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'mary'</span><span class="token punctuation">,</span> <span class="token string">'454578'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'emma'</span><span class="token punctuation">,</span> <span class="token string">'884867'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>主键索引(id)</strong></p> <p><img src="/blog/assets/img/image-20230818212852678.a70e3db1.png" alt="image-20230818212852678"></p> <p><strong>非主键索引(username_index)</strong></p> <p><img src="/blog/assets/img/image-20230818215105580.5f1e7a1c.png" alt="image-20230818215105580"></p> <p><strong>非主键索引(password_index)</strong></p> <p><img src="/blog/assets/img/image-20230818214631151.ae34bebc.png" alt="image-20230818214631151"></p> <h2 id="聚集索引和非聚集索引"><a href="#聚集索引和非聚集索引" class="header-anchor">#</a> 聚集索引和非聚集索引</h2> <h3 id="聚集索引"><a href="#聚集索引" class="header-anchor">#</a> 聚集索引</h3> <p>聚集索引的存储顺序和索引的顺序保持一致，在聚集索引中，叶子结点保存了每一行的数据。</p> <ol><li>如果这张表定义了主键索引，那么这个主键索引就作为聚集索引</li> <li>如果这张表没有定义主键索引，那么该表的第一个唯一非空索引作为聚集索引</li> <li>如果这张表也没有唯一非空索引，那么InnoDB内部会生成一个隐含的主键作为聚集索引，这个隐含的主键是一个6个字节的列，该列的值会随着数据的插入自增。</li></ol> <h3 id="非聚集索引"><a href="#非聚集索引" class="header-anchor">#</a> 非聚集索引</h3> <p>叶子结点存储的是主键值，在根据非聚集索引查询的时候，需要先找到主键，然后回到聚集索引查询，这个过程就是所谓的回表。</p> <h3 id="区别"><a href="#区别" class="header-anchor">#</a> 区别</h3> <table><thead><tr><th style="text-align:center;">-</th> <th style="text-align:center;">聚集索引</th> <th style="text-align:center;">非聚集索引</th></tr></thead> <tbody><tr><td style="text-align:center;">个数</td> <td style="text-align:center;">一个表只能存在一个</td> <td style="text-align:center;">一个表可以存在多个</td></tr> <tr><td style="text-align:center;">索引值</td> <td style="text-align:center;">必须唯一</td> <td style="text-align:center;">可以不唯一</td></tr> <tr><td style="text-align:center;">存储</td> <td style="text-align:center;">物理存储顺序和索引（逻辑）顺序一致</td> <td style="text-align:center;">索引（逻辑）顺序和物理存储顺序不一致</td></tr> <tr><td style="text-align:center;">查询</td> <td style="text-align:center;">一次就可以查找到需要查找的数据</td> <td style="text-align:center;">需要<strong>回表</strong>。第一次只能查找到记录对应的主键值，需要使用主键的值通过（回到）聚集索引查找需要查找的数据</td></tr> <tr><td style="text-align:center;">速度</td> <td style="text-align:center;">快</td> <td style="text-align:center;">慢</td></tr></tbody></table> <h2 id="聚集索引和主键索引的关系"><a href="#聚集索引和主键索引的关系" class="header-anchor">#</a> 聚集索引和主键索引的关系</h2> <p>主键索引一定是聚集索引，聚集索引不一定是主键索引。</p> <p>在InnoDB中，在没有定义主键的情况下，</p> <h2 id="索引的语法"><a href="#索引的语法" class="header-anchor">#</a> 索引的语法</h2> <p>什么样的列适合当索引？</p> <ul><li>数据不重复出现的</li> <li>值不为空的(null)</li> <li>业务场景中查询条件比较多的</li> <li>这一列值不经常变化的</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/skills/DSDB/前端.html" class="prev">
        前端
      </a></span> <span class="next"><a href="/blog/skills/DSDB/连接池.html">
        /skills/DSDB/连接池.html
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.e95f8842.js" defer></script><script src="/blog/assets/js/3.08356745.js" defer></script><script src="/blog/assets/js/13.bf6af2da.js" defer></script>
  </body>
</html>
