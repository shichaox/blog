<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Map | 琅玕的博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="个人编程技术分享">
    
    <link rel="preload" href="/blog/assets/css/0.styles.671fbdd0.css" as="style"><link rel="preload" href="/blog/assets/js/app.e95f8842.js" as="script"><link rel="preload" href="/blog/assets/js/3.08356745.js" as="script"><link rel="preload" href="/blog/assets/js/36.474a6bcb.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.acf34bf9.js"><link rel="prefetch" href="/blog/assets/js/11.fef1fa27.js"><link rel="prefetch" href="/blog/assets/js/12.c774ebf1.js"><link rel="prefetch" href="/blog/assets/js/13.bf6af2da.js"><link rel="prefetch" href="/blog/assets/js/14.7b60b543.js"><link rel="prefetch" href="/blog/assets/js/15.5515032c.js"><link rel="prefetch" href="/blog/assets/js/16.3c0cd04c.js"><link rel="prefetch" href="/blog/assets/js/17.80206c1e.js"><link rel="prefetch" href="/blog/assets/js/18.e5e2c85c.js"><link rel="prefetch" href="/blog/assets/js/19.2f69b079.js"><link rel="prefetch" href="/blog/assets/js/2.9988781b.js"><link rel="prefetch" href="/blog/assets/js/20.7a923a3b.js"><link rel="prefetch" href="/blog/assets/js/21.d81d0001.js"><link rel="prefetch" href="/blog/assets/js/22.2fe5ab39.js"><link rel="prefetch" href="/blog/assets/js/23.99bc8ff5.js"><link rel="prefetch" href="/blog/assets/js/24.1fcf63f7.js"><link rel="prefetch" href="/blog/assets/js/25.a5536fa6.js"><link rel="prefetch" href="/blog/assets/js/26.e2fb222c.js"><link rel="prefetch" href="/blog/assets/js/27.03389df0.js"><link rel="prefetch" href="/blog/assets/js/28.4b72525f.js"><link rel="prefetch" href="/blog/assets/js/29.03a090ad.js"><link rel="prefetch" href="/blog/assets/js/30.87f31b47.js"><link rel="prefetch" href="/blog/assets/js/31.c639ea6f.js"><link rel="prefetch" href="/blog/assets/js/32.795ca246.js"><link rel="prefetch" href="/blog/assets/js/33.647699a4.js"><link rel="prefetch" href="/blog/assets/js/34.2909ac9c.js"><link rel="prefetch" href="/blog/assets/js/35.b5d4b577.js"><link rel="prefetch" href="/blog/assets/js/37.4590b450.js"><link rel="prefetch" href="/blog/assets/js/38.1cfbe263.js"><link rel="prefetch" href="/blog/assets/js/39.4c159456.js"><link rel="prefetch" href="/blog/assets/js/4.1c4b8134.js"><link rel="prefetch" href="/blog/assets/js/40.c52cb9af.js"><link rel="prefetch" href="/blog/assets/js/41.f77d6a1f.js"><link rel="prefetch" href="/blog/assets/js/42.c45631ae.js"><link rel="prefetch" href="/blog/assets/js/43.44644811.js"><link rel="prefetch" href="/blog/assets/js/44.c40d24aa.js"><link rel="prefetch" href="/blog/assets/js/45.0c1b86d7.js"><link rel="prefetch" href="/blog/assets/js/46.85dd5346.js"><link rel="prefetch" href="/blog/assets/js/47.a52d8379.js"><link rel="prefetch" href="/blog/assets/js/48.dfaedde6.js"><link rel="prefetch" href="/blog/assets/js/49.604893e5.js"><link rel="prefetch" href="/blog/assets/js/5.b41d7dd5.js"><link rel="prefetch" href="/blog/assets/js/50.228c7e1a.js"><link rel="prefetch" href="/blog/assets/js/51.7a95ac4e.js"><link rel="prefetch" href="/blog/assets/js/52.79ff7d2e.js"><link rel="prefetch" href="/blog/assets/js/53.7aeffa50.js"><link rel="prefetch" href="/blog/assets/js/54.c7097067.js"><link rel="prefetch" href="/blog/assets/js/6.31dc016b.js"><link rel="prefetch" href="/blog/assets/js/7.96c397d1.js"><link rel="prefetch" href="/blog/assets/js/8.e97d6841.js"><link rel="prefetch" href="/blog/assets/js/9.66ed6f07.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.671fbdd0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">琅玕的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  学习
</a></div><div class="nav-item"><a href="/blog/share/" class="nav-link">
  资源分享
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  学习
</a></div><div class="nav-item"><a href="/blog/share/" class="nav-link">
  资源分享
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/blog/skills/IoT" class="sidebar-heading clickable"><span>IoT</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/IoT/基于NodeMcu的智慧生态农业系统设计.html" class="sidebar-link">基于NodeMcu的智慧生态农业系统设计</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/JavaSE" class="sidebar-heading clickable"><span>JavaSE</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/JavaSE/File类和IO流.html" class="sidebar-link">File类和IO流</a></li><li><a href="/blog/skills/JavaSE/Java基础手写笔记.html" class="sidebar-link">/skills/JavaSE/Java基础手写笔记.html</a></li><li><a href="/blog/skills/JavaSE/Java常用API.html" class="sidebar-link">Java常用API</a></li><li><a href="/blog/skills/JavaSE/Thread.html" class="sidebar-link">Thread</a></li><li><a href="/blog/skills/JavaSE/内部类.html" class="sidebar-link">内部类</a></li><li><a href="/blog/skills/JavaSE/反射.html" class="sidebar-link">反射</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/DSDB" class="sidebar-heading clickable router-link-active open"><span>DSDB</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/DSDB/Collection.html" class="sidebar-link">Java的集合类</a></li><li><a href="/blog/skills/DSDB/HTTP&amp;Tomcat.html" class="sidebar-link">HTTP&amp;Tomcat</a></li><li><a href="/blog/skills/DSDB/JDBC.html" class="sidebar-link">JDBC</a></li><li><a href="/blog/skills/DSDB/Map.html" aria-current="page" class="active sidebar-link">Map</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#什么是map" class="sidebar-link">什么是Map</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#api" class="sidebar-link">API</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#hashmap" class="sidebar-link">HashMap</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#什么是hash" class="sidebar-link">什么是hash</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#初始化容量及扩容" class="sidebar-link">初始化容量及扩容</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#加载因子" class="sidebar-link">加载因子</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#hashmap底层数组结构" class="sidebar-link">HashMap底层数组结构</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#hash的计算" class="sidebar-link">hash的计算</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#hashcode" class="sidebar-link">hashCode</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#a-b-a-b-1-在什么情况下会成立" class="sidebar-link">a % b = a &amp; (b - 1)在什么情况下会成立</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#hashmap对key重复的定义" class="sidebar-link">HashMap对key重复的定义</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#hashmap的添加流程" class="sidebar-link">HashMap的添加流程</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#hashmap的构造方法" class="sidebar-link">HashMap的构造方法</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#扩容后位置的问题" class="sidebar-link">扩容后位置的问题</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#链表转化为红黑树" class="sidebar-link">链表转化为红黑树</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#红黑树转化为链表" class="sidebar-link">红黑树转化为链表</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#hashtable" class="sidebar-link">HashTable</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#hashmap和hashtable的相同点和不同点" class="sidebar-link">HashMap和HashTable的相同点和不同点</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#treemap" class="sidebar-link">TreeMap</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#构造方法" class="sidebar-link">构造方法</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#treemap的api" class="sidebar-link">TreeMap的API</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#linkedhashmap" class="sidebar-link">LinkedHashMap</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#linkedhashmap的构造方法" class="sidebar-link">LinkedHashMap的构造方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/Map.html#properties" class="sidebar-link">Properties</a></li></ul></li><li><a href="/blog/skills/DSDB/Maven.html" class="sidebar-link">Maven</a></li><li><a href="/blog/skills/DSDB/Mybatis.html" class="sidebar-link">Mybatis</a></li><li><a href="/blog/skills/DSDB/SQL.html" class="sidebar-link">SQL</a></li><li><a href="/blog/skills/DSDB/Stream.html" class="sidebar-link">Stream</a></li><li><a href="/blog/skills/DSDB/前端.html" class="sidebar-link">前端</a></li><li><a href="/blog/skills/DSDB/数据库索引.html" class="sidebar-link">数据库索引</a></li><li><a href="/blog/skills/DSDB/连接池.html" class="sidebar-link">/skills/DSDB/连接池.html</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/JavaEE&amp;Spring" class="sidebar-heading clickable"><span>JavaEE&amp;Spring</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/JavaEE&amp;Spring/MyBatis-Spring.html" class="sidebar-link">MyBatis - Spring、Spring事务</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/Request&amp;Response.html" class="sidebar-link">Request &amp; Response</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/Servlet.html" class="sidebar-link">Servlet</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringAOP.html" class="sidebar-link">Spring AOP</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringBoot.html" class="sidebar-link">SpringBoot</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringIOC.html" class="sidebar-link">Spring IOC</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringMVC.html" class="sidebar-link">Spring MVC</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/设计模式.html" class="sidebar-link">设计模式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/微服务" class="sidebar-heading clickable"><span>微服务</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/微服务/ElasticSearch.html" class="sidebar-link">ElasticSearch</a></li><li><a href="/blog/skills/微服务/Gateway.html" class="sidebar-link">Gateway</a></li><li><a href="/blog/skills/微服务/MapStruct.html" class="sidebar-link">MapStruct</a></li><li><a href="/blog/skills/微服务/Mybatis-Plus.html" class="sidebar-link">Mybatis-Plus</a></li><li><a href="/blog/skills/微服务/Nginx.html" class="sidebar-link">Nginx</a></li><li><a href="/blog/skills/微服务/Redis.html" class="sidebar-link">Redis</a></li><li><a href="/blog/skills/微服务/Redis在Java项目中的使用.html" class="sidebar-link">Redis在Java项目中的使用</a></li><li><a href="/blog/skills/微服务/RocketMQ.html" class="sidebar-link">RocketMQ</a></li><li><a href="/blog/skills/微服务/SpringCloud.html" class="sidebar-link">SpringCloud</a></li><li><a href="/blog/skills/微服务/微服务.html" class="sidebar-link">微服务</a></li><li><a href="/blog/skills/微服务/微服务架构和单体架构.html" class="sidebar-link">微服务架构和单体架构</a></li><li><a href="/blog/skills/微服务/秒杀.html" class="sidebar-link">秒杀</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/面试" class="sidebar-heading clickable"><span>面试</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/面试/面经.html" class="sidebar-link">面经</a></li><li><a href="/blog/skills/面试/面试准备.html" class="sidebar-link">面试准备</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="map"><a href="#map" class="header-anchor">#</a> Map</h1> <table><thead><tr><th style="text-align:center;"></th> <th style="text-align:center;">父类接口</th> <th style="text-align:center;">底层结构</th> <th style="text-align:center;">扩容机制</th> <th style="text-align:center;">存储是否有序</th> <th style="text-align:center;">存储是否允许重复</th> <th style="text-align:center;">是否允许存储null</th></tr></thead> <tbody><tr><td style="text-align:center;">Map</td> <td style="text-align:center;">-</td> <td style="text-align:center;">-</td> <td style="text-align:center;">-</td> <td style="text-align:center;">部分有序</td> <td style="text-align:center;">不能(指的是key不能重复)</td> <td style="text-align:center;">部分允许</td></tr> <tr><td style="text-align:center;">HashMap</td> <td style="text-align:center;">Map</td> <td style="text-align:center;">数组+链表+红黑树</td> <td style="text-align:center;">默认长度是16，扩容机制2倍</td> <td style="text-align:center;">无序</td> <td style="text-align:center;">不允许</td> <td style="text-align:center;"><strong>允许</strong></td></tr> <tr><td style="text-align:center;">LinkedHashMap</td> <td style="text-align:center;">HashMap</td> <td style="text-align:center;">完全复用了父类的结构、方法， 在父类的基础上维护了一个双向链表</td> <td style="text-align:center;">-</td> <td style="text-align:center;"><strong>有序</strong></td> <td style="text-align:center;">不允许</td> <td style="text-align:center;"><strong>允许</strong></td></tr> <tr><td style="text-align:center;">HashTable</td> <td style="text-align:center;">Map</td> <td style="text-align:center;">数组+链表</td> <td style="text-align:center;">数组长度默认是11，默认扩容机制是2倍+1</td> <td style="text-align:center;">无序</td> <td style="text-align:center;">不允许</td> <td style="text-align:center;">不允许存储null作为Key和value</td></tr> <tr><td style="text-align:center;">TreeMap</td> <td style="text-align:center;">Map</td> <td style="text-align:center;">红黑树</td> <td style="text-align:center;">-</td> <td style="text-align:center;"><strong>存储数据大小有序</strong></td> <td style="text-align:center;">不允许</td> <td style="text-align:center;">不允许</td></tr></tbody></table> <h2 id="什么是map"><a href="#什么是map" class="header-anchor">#</a> 什么是Map</h2> <p>Map就是用来存储键值对的接口，Collection存储的是单列的数据，Map存储的是键值对(key-value)，key和value成对存储，可以通过key值查找对应的value。在Map中，key不允许重复。</p> <h2 id="api"><a href="#api" class="header-anchor">#</a> API</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//新增、删除、查找</span>
<span class="token class-name">V</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">)</span><span class="token operator">:</span>添加键值对，如果键值对存在，就是更新键值对
<span class="token keyword">void</span> <span class="token function">putAll</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> m<span class="token punctuation">)</span>：将一个map的所有键值对都放入这个map

<span class="token class-name">V</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span>：根据一个key获取value，如果key不存在就返回<span class="token keyword">null</span>

<span class="token class-name">V</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span>：删除map中key对应的键值对

<span class="token keyword">boolean</span> <span class="token function">containsKey</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span>：判断map中是否包含这个key

<span class="token keyword">boolean</span> <span class="token function">containsValue</span><span class="token punctuation">(</span><span class="token class-name">Object</span> value<span class="token punctuation">)</span>：判断map中是否包含这个value

<span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：清空map

<span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span>：判断两个map是否相等

<span class="token keyword">int</span> hashCode：返回此映射的哈希码值

<span class="token keyword">boolean</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：判断map中是否为空

<span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：返回map的大小，键值对个数

<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：返回此映射中包含映射关系的<span class="token class-name">Set</span>视图

<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> <span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：返回此映射中包含的键的<span class="token class-name">Set</span>

<span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：返回此映射中值的<span class="token class-name">Collection</span>
</code></pre></div><table><thead><tr><th style="text-align:center;"></th> <th style="text-align:center;">Map</th> <th style="text-align:center;">HashMap</th> <th>LinkedHashMap</th> <th>HashTable</th> <th>TreeMap</th> <th style="text-align:center;"></th></tr></thead> <tbody><tr><td style="text-align:center;">新增</td> <td style="text-align:center;">V put(K key, V value)</td> <td style="text-align:center;"></td> <td></td> <td></td> <td>Map.Entry&lt;K, V&gt; ceilingEntry(K key)</td> <td style="text-align:center;">大于等于给定key的最小键值对</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">void putAll(Map&lt;? extends K, ? extends V&gt; m)</td> <td style="text-align:center;"></td> <td></td> <td></td> <td>K ceilingKey(K key)</td> <td style="text-align:center;">大于等于给定key的最小key</td></tr> <tr><td style="text-align:center;">删除</td> <td style="text-align:center;">V remove(key)</td> <td style="text-align:center;"></td> <td></td> <td></td> <td>Map.Entry&lt;K, V&gt; floorEntry(K key)</td> <td style="text-align:center;">小于等于key的最大键值对</td></tr> <tr><td style="text-align:center;">查找</td> <td style="text-align:center;">V get(key)</td> <td style="text-align:center;"></td> <td></td> <td></td> <td>Map.Entry(K, V&gt; higherEntry(K key)</td> <td style="text-align:center;">大于给定key的最小键值对</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">containsKey(key)</td> <td style="text-align:center;"></td> <td></td> <td></td> <td>Map.Entry&lt;K, V&gt; lowerEntry&lt;K key</td> <td style="text-align:center;">小于key的最大键值对</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">containsValue(value)</td> <td style="text-align:center;"></td> <td></td> <td></td> <td>K lowerKey(K key)</td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">void clear()</td> <td style="text-align:center;"></td> <td></td> <td></td> <td>Map.Entry&lt;K, V&gt; firstEntry()</td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">boolean isEmpty()</td> <td style="text-align:center;"></td> <td></td> <td></td> <td>Map.Entry&lt;K, V&gt; lastEntry()</td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">int size()</td> <td style="text-align:center;"></td> <td></td> <td></td> <td>Map.Entry&lt;K, V&gt; poolFirstEntry()</td> <td style="text-align:center;">删除最小的键值对</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">Set&lt;Map, Entry&lt;K, V&gt;&gt; entrySet()</td> <td style="text-align:center;"></td> <td></td> <td></td> <td>Map.Entry&lt;K, V&gt; pollLastEntry()</td> <td style="text-align:center;">删除最大的键值对</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">Set<K> keySet()</K></td> <td style="text-align:center;"></td> <td></td> <td></td> <td></td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:center;">Collection<V> values</V></td> <td style="text-align:center;"></td> <td></td> <td></td> <td></td> <td style="text-align:center;"></td></tr></tbody></table> <h2 id="hashmap"><a href="#hashmap" class="header-anchor">#</a> HashMap</h2> <h3 id="什么是hash"><a href="#什么是hash" class="header-anchor">#</a> 什么是hash</h3> <p>就是把固定或<strong>任意长度</strong>的输入（hashCode，hash），通过散列算法变换成<strong>固定长度的输出</strong>（数组下标），该输出就是散列值。一个输入对应一个输出，多个输入可能对应一个输出（hash冲突）。</p> <h3 id="初始化容量及扩容"><a href="#初始化容量及扩容" class="header-anchor">#</a> 初始化容量及扩容</h3> <p>HashMap的底层数组的初始容量是16，扩容机制是2倍。</p> <h3 id="加载因子"><a href="#加载因子" class="header-anchor">#</a> 加载因子</h3> <p>在HashMap底层维护了一个加载因子，用来表示存储到多少就扩容。</p> <p>默认数组长度16，默认加载因子是0.75f，阈值 = 16 * 0.75 = 12。当HashMap存储的键值对数量超过阈值，就会触发数组扩容。</p> <h3 id="hashmap底层数组结构"><a href="#hashmap底层数组结构" class="header-anchor">#</a> HashMap底层数组结构</h3> <p>HashMap的底层结构是数组+链表+红黑树</p> <p>HashMap数组底层存储的key-value是以Node结点存储的。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Node</span> <span class="token punctuation">{</span>
    <span class="token class-name">K</span> key<span class="token punctuation">;</span>
    <span class="token class-name">V</span> value<span class="token punctuation">;</span>
    <span class="token keyword">int</span> hash<span class="token punctuation">;</span>
    <span class="token class-name">Node</span> next<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">transient</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> table<span class="token punctuation">;</span>
</code></pre></div><h3 id="hash的计算"><a href="#hash的计算" class="header-anchor">#</a> hash的计算</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> h<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>为什么</p> <p>hashCode ^ (hashCode右移16位)</p> <p><strong>因为计算键值对在数组中存储地址（索引）的方式是hashcode &amp; (length - 1)</strong></p> <p><strong>其中length为底层数组长度，上述操作相当于hashCode % length, （因为length都是2的倍数，length = 2^n)</strong>
$$
length - 1 = 2^n - 1
$$
那么上述操作就相当于保留hashCode的低n位，如果直接用hashCode计算索引的位置的话，hashCode的高位数据就会丢失，就会导致很多hash值不同，而低位没有区别的数计算出来的数组索引是一样的，从而导致很多数据发生冲突。为了避免这种情况，hashMap将高16位与低16位进行异或操作，再用计算出的结果对数组长度取余（和数组长度 - 1 &amp;操作）得到索引，这样就可以保证高位的数据也可以参与到&amp;运算中来，以增加索引的散列程度让数据分布的更加均匀。</p> <h3 id="hashcode"><a href="#hashcode" class="header-anchor">#</a> hashCode</h3> <p>是根据对象的某些信息推导出来的int类型的值，默认情况下是对象的存储地址，主要用于在散列存储结构中确定元素的存储地址，例如HashMap、HashTable。</p> <h3 id="a-b-a-b-1-在什么情况下会成立"><a href="#a-b-a-b-1-在什么情况下会成立" class="header-anchor">#</a> a % b = a &amp; (b - 1)在什么情况下会成立</h3> <p>只有在b 等于2的幂时才会成立
$$
b = 2 ^ n
$$
也就是说，b的第n + 1位为1，低n位都为0。将a拆成两部分的和，一部分是低n位，另一部分是剩下的高位部分，高位的部分一定会被b整除，所以取余剩下来的就是低n位，a低n位就是取余后的结果，既然如此，保留b的低n位就是取余后的结果，而a和n个1相&amp;就可以保留低n位。</p> <h3 id="hashmap对key重复的定义"><a href="#hashmap对key重复的定义" class="header-anchor">#</a> HashMap对key重复的定义</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>hashmap中对重复的定义<code>(p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))</code>为什么要求hash相同？</p> <ol><li>元素相同，hash一定相同。（同一元素的hashCode一定相同，hash也必然相同）</li> <li>hash相同，元素不一定相同。（不同的元素可能会发生hash冲突，hash相同）</li></ol> <p>综上所述，hash相同是元素相同的前提，必要条件，只有hash相同才会有可能元素相同。</p> <p><code>k = p.key) == key</code> 是引用相同，也就是同一个对象。</p> <p><code>key != null &amp;&amp; key.equals(k)</code> 是，基于该对象的equals比较方法判断，这两个元素相同。</p> <p>我们在使用自定义的类作为Key时，需要重写equals()方法和hashCode()方法。</p> <h3 id="hashmap的添加流程"><a href="#hashmap的添加流程" class="header-anchor">#</a> HashMap的添加流程</h3> <ol><li><p>计算key的hash</p> <p><code>(key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16)</code></p></li> <li><p>使用计算得到的hash与底层数组长度n取余，得到这个键值对在数组上的位置。</p> <p><code>hash % n = hash &amp; (n - 1)</code></p></li> <li><p>检查计算得到的数组位置上是否有键值对</p> <p>(1) 如果没有元素，就直接新建结点，然后插入到数组。</p> <p>(2) 如果数组位置有元素，就比较是否相等。</p> <p>判断标准：</p> <p><code>p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))</code></p> <p>​	如果相等，就直接用新的value替代旧的value，添加结束。</p> <p>​	如果不相等，则继续往下比较（链表、红黑树），直到最后一个也不相等，就把他插入到末尾。</p></li> <li><p>如果是链表，插入后长度超过阈值（8），则可能会转化为红黑树。</p> <p><strong>如果数组长度小于64，不会转化为红黑树，会直接扩容。</strong></p></li> <li><p>如果插入后Map中结点数超过阈值（加载因子 * 数组长度），则会进行扩容，</p></li></ol> <h3 id="hashmap的构造方法"><a href="#hashmap的构造方法" class="header-anchor">#</a> HashMap的构造方法</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//无参构造</span>
<span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//指定初始容量、默认加载因子</span>
<span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">)</span>

<span class="token comment">//指定初始容量、加载因子</span>
<span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">,</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">)</span>

<span class="token comment">//</span>
<span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> m<span class="token punctuation">)</span>   
</code></pre></div><h3 id="扩容后位置的问题"><a href="#扩容后位置的问题" class="header-anchor">#</a> 扩容后位置的问题</h3> <p>原位置：hash % 16 = x</p> <p>新位置：hash % 32 = (x + 16 * n) 等于x或x + 16</p> <p>元素在新数组的位置，等于原位置或原位置 + 旧数组长度</p> <h3 id="链表转化为红黑树"><a href="#链表转化为红黑树" class="header-anchor">#</a> 链表转化为红黑树</h3> <p>当某个数组位置链表长度超过8的时候，就要由链表转换成红黑树。</p> <p>当链表长度超过8时一定会转化成红黑树吗？为什么？</p> <h3 id="红黑树转化为链表"><a href="#红黑树转化为链表" class="header-anchor">#</a> 红黑树转化为链表</h3> <p>有两种情况：</p> <ol><li><p>删除数据的时候，要删除的数据在红黑树上，删除数据导致红黑树上的数据减少，由红黑树转化成链表。</p></li> <li><p>扩容的时候，一个红黑树再扩容后，会被拆成两部分，任意部分数据过少，都会由红黑树转化成链表。</p> <p>红黑树拆成低位（旧位置）和高位（旧位置 + 旧数组长度）两部分，任意部分分配的数据<strong>小于等于6</strong>，就要由红黑树转化成链表。</p> <p>为什么会被拆成这两部分？参考<strong>扩容后位置的问题</strong></p></li></ol> <h2 id="hashtable"><a href="#hashtable" class="header-anchor">#</a> HashTable</h2> <p>线程安全，jdk1.0的时候出现，HashMap是jdk1.2的时候出现。HashMap的出现就是为了取代HashTable。HashMap的红黑树是在1.8才加上去的，所以在此之前两个的结构是一样的。</p> <h3 id="hashmap和hashtable的相同点和不同点"><a href="#hashmap和hashtable的相同点和不同点" class="header-anchor">#</a> HashMap和HashTable的相同点和不同点</h3> <table><thead><tr><th style="text-align:center;"></th> <th style="text-align:center;">父类接口</th> <th style="text-align:center;">底层结构</th> <th style="text-align:center;">存储是否有序</th> <th style="text-align:center;">是否允许存储重复元素</th> <th style="text-align:center;">是否允许存储null</th> <th style="text-align:center;">线程安全</th></tr></thead> <tbody><tr><td style="text-align:center;">HashMap</td> <td style="text-align:center;">Map</td> <td style="text-align:center;">1.8之前 数组+链表 1.8之后数组+链表+红黑树</td> <td style="text-align:center;">无序</td> <td style="text-align:center;">不允许</td> <td style="text-align:center;">允许</td> <td style="text-align:center;">不安全</td></tr> <tr><td style="text-align:center;">HashTable</td> <td style="text-align:center;">Map</td> <td style="text-align:center;">数组+链表</td> <td style="text-align:center;">无序</td> <td style="text-align:center;">不允许</td> <td style="text-align:center;">不允许</td> <td style="text-align:center;">安全</td></tr></tbody></table> <p>为什么不使用线程安全的类？</p> <h2 id="treemap"><a href="#treemap" class="header-anchor">#</a> TreeMap</h2> <h3 id="构造方法"><a href="#构造方法" class="header-anchor">#</a> 构造方法</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//无参构造</span>
<span class="token class-name">TreeMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//给定比较器</span>
<span class="token class-name">TreeMap</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> comparator<span class="token punctuation">)</span>
    
<span class="token comment">//构造一个与给定映射具有相同映射关系的新的树映射，该映射根据其键的自然排序进行排序</span>
<span class="token class-name">Treemap</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> m<span class="token punctuation">)</span>
    
<span class="token comment">//构造一个与指定有序映射，具有相同映射关系和相同排序规则的新的树映射</span>
<span class="token class-name">TreeMap</span><span class="token punctuation">(</span><span class="token class-name">SortedMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> m<span class="token punctuation">)</span>  
  
</code></pre></div><h3 id="treemap的api"><a href="#treemap的api" class="header-anchor">#</a> TreeMap的API</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">ceilingEntry</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">)</span><span class="token operator">:</span>大于等于key的最小键值对

</code></pre></div><p>K ceilingKey(K key): 大于等于key的最小key</p> <p>Map.Entry&lt;K, V&gt; floorEntry(K key): 小于等于key的最大键值对</p> <p>K floorKey(K key): 小于等于key的最大key</p> <h2 id="linkedhashmap"><a href="#linkedhashmap" class="header-anchor">#</a> LinkedHashMap</h2> <ol><li>LinkedHashMap是HashMap的一个子类</li> <li>底层完全复用了父类HashMap的结构、参数、方法</li> <li>在HashMap的基础上，额外的维护了一个双向链表，以保证迭代顺序</li> <li>存储元素有序</li> <li>不允许存储重复的元素</li> <li>允许存储null</li></ol> <h3 id="linkedhashmap的构造方法"><a href="#linkedhashmap的构造方法" class="header-anchor">#</a> LinkedHashMap的构造方法</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">LinkedHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token class-name">LinkedHashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCaapacity<span class="token punctuation">)</span>

<span class="token class-name">LinkedHashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">,</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">)</span>

<span class="token class-name">LinkedHashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">,</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">,</span> <span class="token keyword">boolean</span> accessOrder<span class="token punctuation">)</span>

<span class="token class-name">LinkedHashMap</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> m<span class="token punctuation">)</span>
</code></pre></div><h2 id="properties"><a href="#properties" class="header-anchor">#</a> Properties</h2> <p>HashTable的子类，用于处理配置文件。</p> <p>配置文件1.properties</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token key attr-name">username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token key attr-name">pwd</span><span class="token punctuation">=</span><span class="token value attr-value">12345</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
properties<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">&quot;1.properties&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//获取配置文件中的value</span>
<span class="token class-name">String</span> username <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> pwd <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;pwd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>username <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//修改配置文件</span>
properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">&quot;pwd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;666666&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;----修改后的----&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>username <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemResource</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/skills/DSDB/JDBC.html" class="prev">
        JDBC
      </a></span> <span class="next"><a href="/blog/skills/DSDB/Maven.html">
        Maven
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.e95f8842.js" defer></script><script src="/blog/assets/js/3.08356745.js" defer></script><script src="/blog/assets/js/36.474a6bcb.js" defer></script>
  </body>
</html>
