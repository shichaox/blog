<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JDBC | 琅玕的博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="个人编程技术分享">
    
    <link rel="preload" href="/blog/assets/css/0.styles.671fbdd0.css" as="style"><link rel="preload" href="/blog/assets/js/app.e95f8842.js" as="script"><link rel="preload" href="/blog/assets/js/3.08356745.js" as="script"><link rel="preload" href="/blog/assets/js/35.b5d4b577.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.acf34bf9.js"><link rel="prefetch" href="/blog/assets/js/11.fef1fa27.js"><link rel="prefetch" href="/blog/assets/js/12.c774ebf1.js"><link rel="prefetch" href="/blog/assets/js/13.bf6af2da.js"><link rel="prefetch" href="/blog/assets/js/14.7b60b543.js"><link rel="prefetch" href="/blog/assets/js/15.5515032c.js"><link rel="prefetch" href="/blog/assets/js/16.3c0cd04c.js"><link rel="prefetch" href="/blog/assets/js/17.80206c1e.js"><link rel="prefetch" href="/blog/assets/js/18.e5e2c85c.js"><link rel="prefetch" href="/blog/assets/js/19.2f69b079.js"><link rel="prefetch" href="/blog/assets/js/2.9988781b.js"><link rel="prefetch" href="/blog/assets/js/20.7a923a3b.js"><link rel="prefetch" href="/blog/assets/js/21.d81d0001.js"><link rel="prefetch" href="/blog/assets/js/22.2fe5ab39.js"><link rel="prefetch" href="/blog/assets/js/23.99bc8ff5.js"><link rel="prefetch" href="/blog/assets/js/24.1fcf63f7.js"><link rel="prefetch" href="/blog/assets/js/25.a5536fa6.js"><link rel="prefetch" href="/blog/assets/js/26.e2fb222c.js"><link rel="prefetch" href="/blog/assets/js/27.03389df0.js"><link rel="prefetch" href="/blog/assets/js/28.4b72525f.js"><link rel="prefetch" href="/blog/assets/js/29.03a090ad.js"><link rel="prefetch" href="/blog/assets/js/30.87f31b47.js"><link rel="prefetch" href="/blog/assets/js/31.c639ea6f.js"><link rel="prefetch" href="/blog/assets/js/32.795ca246.js"><link rel="prefetch" href="/blog/assets/js/33.647699a4.js"><link rel="prefetch" href="/blog/assets/js/34.2909ac9c.js"><link rel="prefetch" href="/blog/assets/js/36.474a6bcb.js"><link rel="prefetch" href="/blog/assets/js/37.4590b450.js"><link rel="prefetch" href="/blog/assets/js/38.1cfbe263.js"><link rel="prefetch" href="/blog/assets/js/39.4c159456.js"><link rel="prefetch" href="/blog/assets/js/4.1c4b8134.js"><link rel="prefetch" href="/blog/assets/js/40.c52cb9af.js"><link rel="prefetch" href="/blog/assets/js/41.f77d6a1f.js"><link rel="prefetch" href="/blog/assets/js/42.c45631ae.js"><link rel="prefetch" href="/blog/assets/js/43.44644811.js"><link rel="prefetch" href="/blog/assets/js/44.c40d24aa.js"><link rel="prefetch" href="/blog/assets/js/45.0c1b86d7.js"><link rel="prefetch" href="/blog/assets/js/46.85dd5346.js"><link rel="prefetch" href="/blog/assets/js/47.a52d8379.js"><link rel="prefetch" href="/blog/assets/js/48.dfaedde6.js"><link rel="prefetch" href="/blog/assets/js/49.604893e5.js"><link rel="prefetch" href="/blog/assets/js/5.b41d7dd5.js"><link rel="prefetch" href="/blog/assets/js/50.228c7e1a.js"><link rel="prefetch" href="/blog/assets/js/51.7a95ac4e.js"><link rel="prefetch" href="/blog/assets/js/52.79ff7d2e.js"><link rel="prefetch" href="/blog/assets/js/53.7aeffa50.js"><link rel="prefetch" href="/blog/assets/js/54.c7097067.js"><link rel="prefetch" href="/blog/assets/js/6.31dc016b.js"><link rel="prefetch" href="/blog/assets/js/7.96c397d1.js"><link rel="prefetch" href="/blog/assets/js/8.e97d6841.js"><link rel="prefetch" href="/blog/assets/js/9.66ed6f07.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.671fbdd0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">琅玕的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  学习
</a></div><div class="nav-item"><a href="/blog/share/" class="nav-link">
  资源分享
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  学习
</a></div><div class="nav-item"><a href="/blog/share/" class="nav-link">
  资源分享
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/blog/skills/IoT" class="sidebar-heading clickable"><span>IoT</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/IoT/基于NodeMcu的智慧生态农业系统设计.html" class="sidebar-link">基于NodeMcu的智慧生态农业系统设计</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/JavaSE" class="sidebar-heading clickable"><span>JavaSE</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/JavaSE/File类和IO流.html" class="sidebar-link">File类和IO流</a></li><li><a href="/blog/skills/JavaSE/Java基础手写笔记.html" class="sidebar-link">/skills/JavaSE/Java基础手写笔记.html</a></li><li><a href="/blog/skills/JavaSE/Java常用API.html" class="sidebar-link">Java常用API</a></li><li><a href="/blog/skills/JavaSE/Thread.html" class="sidebar-link">Thread</a></li><li><a href="/blog/skills/JavaSE/内部类.html" class="sidebar-link">内部类</a></li><li><a href="/blog/skills/JavaSE/反射.html" class="sidebar-link">反射</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/DSDB" class="sidebar-heading clickable router-link-active open"><span>DSDB</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/DSDB/Collection.html" class="sidebar-link">Java的集合类</a></li><li><a href="/blog/skills/DSDB/HTTP&amp;Tomcat.html" class="sidebar-link">HTTP&amp;Tomcat</a></li><li><a href="/blog/skills/DSDB/JDBC.html" aria-current="page" class="active sidebar-link">JDBC</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#介绍" class="sidebar-link">介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#数据库访问过程" class="sidebar-link">数据库访问过程</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#什么是jdbc" class="sidebar-link">什么是JDBC</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#jdbc的使用" class="sidebar-link">JDBC的使用</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#使用jdbc进行增删改查" class="sidebar-link">使用JDBC进行增删改查</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#jdbc-api" class="sidebar-link">JDBC API</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#jdbc的优化" class="sidebar-link">JDBC的优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#提取工具类" class="sidebar-link">提取工具类</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#为什么要用配置文件写参数" class="sidebar-link">为什么要用配置文件写参数？</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#为什么要用反射注册驱动" class="sidebar-link">为什么要用反射注册驱动？</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#sql注入问题" class="sidebar-link">SQL注入问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#什么是sql注入" class="sidebar-link">什么是SQL注入</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#解决sql注入问题" class="sidebar-link">解决SQL注入问题</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#批处理" class="sidebar-link">批处理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#for循环逐条插入" class="sidebar-link">for循环逐条插入</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#statement批处理" class="sidebar-link">statement批处理</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#preparedstatement批处理" class="sidebar-link">PreparedStatement批处理</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#事务" class="sidebar-link">事务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#介绍-2" class="sidebar-link">介绍</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#转账事务示例" class="sidebar-link">转账事务示例</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#特性" class="sidebar-link">特性</a></li><li class="sidebar-sub-header"><a href="/blog/skills/DSDB/JDBC.html#隔离级别" class="sidebar-link">隔离级别</a></li></ul></li></ul></li><li><a href="/blog/skills/DSDB/Map.html" class="sidebar-link">Map</a></li><li><a href="/blog/skills/DSDB/Maven.html" class="sidebar-link">Maven</a></li><li><a href="/blog/skills/DSDB/Mybatis.html" class="sidebar-link">Mybatis</a></li><li><a href="/blog/skills/DSDB/SQL.html" class="sidebar-link">SQL</a></li><li><a href="/blog/skills/DSDB/Stream.html" class="sidebar-link">Stream</a></li><li><a href="/blog/skills/DSDB/前端.html" class="sidebar-link">前端</a></li><li><a href="/blog/skills/DSDB/数据库索引.html" class="sidebar-link">数据库索引</a></li><li><a href="/blog/skills/DSDB/连接池.html" class="sidebar-link">/skills/DSDB/连接池.html</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/JavaEE&amp;Spring" class="sidebar-heading clickable"><span>JavaEE&amp;Spring</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/JavaEE&amp;Spring/MyBatis-Spring.html" class="sidebar-link">MyBatis - Spring、Spring事务</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/Request&amp;Response.html" class="sidebar-link">Request &amp; Response</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/Servlet.html" class="sidebar-link">Servlet</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringAOP.html" class="sidebar-link">Spring AOP</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringBoot.html" class="sidebar-link">SpringBoot</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringIOC.html" class="sidebar-link">Spring IOC</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/SpringMVC.html" class="sidebar-link">Spring MVC</a></li><li><a href="/blog/skills/JavaEE&amp;Spring/设计模式.html" class="sidebar-link">设计模式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/微服务" class="sidebar-heading clickable"><span>微服务</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/微服务/ElasticSearch.html" class="sidebar-link">ElasticSearch</a></li><li><a href="/blog/skills/微服务/Gateway.html" class="sidebar-link">Gateway</a></li><li><a href="/blog/skills/微服务/MapStruct.html" class="sidebar-link">MapStruct</a></li><li><a href="/blog/skills/微服务/Mybatis-Plus.html" class="sidebar-link">Mybatis-Plus</a></li><li><a href="/blog/skills/微服务/Nginx.html" class="sidebar-link">Nginx</a></li><li><a href="/blog/skills/微服务/Redis.html" class="sidebar-link">Redis</a></li><li><a href="/blog/skills/微服务/Redis在Java项目中的使用.html" class="sidebar-link">Redis在Java项目中的使用</a></li><li><a href="/blog/skills/微服务/RocketMQ.html" class="sidebar-link">RocketMQ</a></li><li><a href="/blog/skills/微服务/SpringCloud.html" class="sidebar-link">SpringCloud</a></li><li><a href="/blog/skills/微服务/微服务.html" class="sidebar-link">微服务</a></li><li><a href="/blog/skills/微服务/微服务架构和单体架构.html" class="sidebar-link">微服务架构和单体架构</a></li><li><a href="/blog/skills/微服务/秒杀.html" class="sidebar-link">秒杀</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/skills/面试" class="sidebar-heading clickable"><span>面试</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/面试/面经.html" class="sidebar-link">面经</a></li><li><a href="/blog/skills/面试/面试准备.html" class="sidebar-link">面试准备</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="jdbc"><a href="#jdbc" class="header-anchor">#</a> JDBC</h1> <h2 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h2> <h3 id="数据库访问过程"><a href="#数据库访问过程" class="header-anchor">#</a> 数据库访问过程</h3> <p>数据库一般是C/S架构，通过客户端对服务端发起请求，服务端返回结果。</p> <h3 id="什么是jdbc"><a href="#什么是jdbc" class="header-anchor">#</a> 什么是JDBC</h3> <p>JDBC(Java Database Connectivity)是Java程序与数据库进行交互的一种标准接口。它定义了一组Java API，使得Java程序可以通过这些API来连接和操作各种关系型数据库，执行SQL语句并处理查询结果。</p> <p>JDBC提供了一种跨平台、可移植的方式来访问数据库，使得Java程序可以与不同的数据库进行通信而无需改变代码。</p> <p>JDBC的主要优点：可移植性、可靠性、安全性和易于使用。</p> <h2 id="jdbc的使用"><a href="#jdbc的使用" class="header-anchor">#</a> JDBC的使用</h2> <ol><li>注册驱动</li> <li>建立连接</li> <li>通过连接创建statement对象</li> <li>发送SQL语句</li> <li>处理数据</li> <li>关闭连接</li></ol> <h2 id="使用jdbc进行增删改查"><a href="#使用jdbc进行增删改查" class="header-anchor">#</a> 使用JDBC进行增删改查</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//增</span>
<span class="token keyword">int</span> affectedRows1 <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token string">&quot;insert into stu values (1, '张三', 22)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 删</span>
<span class="token keyword">int</span> affectedRows2 <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token string">&quot;delete from stu where id = 3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 改</span>
<span class="token keyword">int</span> affectedRows3 <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token string">&quot;update stu set name = '王五' where id = 4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 查</span>
<span class="token class-name">ResultSet</span> resultSet <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token string">&quot;select * from stu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">while</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> id <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> name <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> age <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="jdbc-api"><a href="#jdbc-api" class="header-anchor">#</a> JDBC API</h2> <table><thead><tr><th>API</th> <th>描述</th></tr></thead> <tbody><tr><td>DriverManager</td> <td>驱动管理器。可以帮助我们管理驱动，获取连接。</td></tr> <tr><td>Connection</td> <td>指代连接对象。</td></tr> <tr><td>Statement</td> <td>Statement对象用于执行SQL语句，并且返回这个SQL语句产生的结果集。</td></tr> <tr><td>ResultSet</td> <td>查询的结果集。</td></tr></tbody></table> <h2 id="jdbc的优化"><a href="#jdbc的优化" class="header-anchor">#</a> JDBC的优化</h2> <h3 id="提取工具类"><a href="#提取工具类" class="header-anchor">#</a> 提取工具类</h3> <ol><li>url、username、pwd、driverClassName等参数通过配置文件获取。</li> <li>通过类加载的方式（反射）注册驱动。</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcUtil</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> pwd<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> driverClassName<span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            properties<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc.properties&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        url <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        username <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pwd <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;pwd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        driverClassName <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;driverClassName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverClassName<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> username<span class="token punctuation">,</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>jdbc.properties配置文件</strong></p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token key attr-name">url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://localhost:3306/demo1?useSSL=false&amp;characterEncoding=utf8</span>
<span class="token key attr-name">username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token key attr-name">pwd</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token key attr-name">driverClassName</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.jdbc.Driver</span>
</code></pre></div><h3 id="为什么要用配置文件写参数"><a href="#为什么要用配置文件写参数" class="header-anchor">#</a> 为什么要用配置文件写参数？</h3> <p>方便，这样项目在不同环境下运行就可以直接修改配置文件来设置参数，不用修改代码。</p> <p>通过修改代码来修改参数不进步方便还会带来很多问题，</p> <ol><li>直接在代码修改参数需要在代码中找到该参数所在的地方，与配置文件相比不够直观。</li> <li>直接在代码中修改参数容易引发问题，修改代码后需要对代码重新进行测试。使用配置文件修改后可以直接使用，无需额外工作。</li></ol> <h3 id="为什么要用反射注册驱动"><a href="#为什么要用反射注册驱动" class="header-anchor">#</a> 为什么要用反射注册驱动？</h3> <p>解耦，方便更换数据库，这样更换数据库只需要在配置文件中修改要更换的驱动的类名就可以了，<strong>无需修改代码</strong>。因为<strong>在书写代码时不用写JDBC任何具体的实现类的内容</strong>，在运行时才通过类加载注册驱动，所以修改驱动只需要修改类加载的类名就可以了，而类加载的类名可以直接存放在配置文件中，故而使用类加载的方法加载驱动无需修改代码。</p> <p>以com.mysql.jdbc.Driver举例：</p> <p>在使用Class.forName(&quot;com.mysql.jdbc.Driver&quot;);进行类加载时，该类的静态代码块会执行注册驱动</p> <p><code>DriverManager.registerDriver(new Driver());</code></p> <p><strong>com.mysql.jdbc.Driver类</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Driver</span> <span class="token keyword">extends</span> <span class="token class-name">NonRegisteringDriver</span> <span class="token keyword">implements</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span>Driver</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Driver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//注册驱动</span>
            <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">registerDriver</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Driver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> var1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;Can't register driver!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="sql注入问题"><a href="#sql注入问题" class="header-anchor">#</a> SQL注入问题</h2> <h3 id="什么是sql注入"><a href="#什么是sql注入" class="header-anchor">#</a> 什么是SQL注入</h3> <p>比如我们在前端搜索框输入数据，后端最后会将输入的字符串和SQL语句拼接，去数据库查询数据，当我们在输入框输入的字符串携带的有SQL语句的时候，如果直接将该携带有SQL语句的字符串和后端SQL语句拼接，数据库就会执行恶意携带的SQL语句，攻击者从而能操作我们的数据库。</p> <h3 id="解决sql注入问题"><a href="#解决sql注入问题" class="header-anchor">#</a> 解决SQL注入问题</h3> <p>使用PreparedStatement(预编译的statement)，将SQL语句和参数分两次发送给SQL服务端。</p> <p>原理：</p> <ol><li>将SQL语句的参数部分用占位符(?)代替，然后将这个SQL语句发送给SQL服务端，服务端对该语句进行预编译。</li> <li>客户端将参数发送给SQL服务端，这些参数就不会参与编译，就会被当成普通字符串处理，而不会解析关键字。所以参数中注入的SQL语句就不会被解析为关键字。（没有经过语法分析、词法分析，只会当做普通字符串处理）</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyPrepareStatement</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span><span class="token punctuation">,</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;登录成功！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;登录失败！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">JdbcUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;select * from user where username=? and password=?&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> preparedStatement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> resultSet <span class="token operator">=</span> preparedStatement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="批处理"><a href="#批处理" class="header-anchor">#</a> 批处理</h2> <h3 id="for循环逐条插入"><a href="#for循环逐条插入" class="header-anchor">#</a> for循环逐条插入</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">batchUseFor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Statement</span> statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;insert into batch_test values (&quot;</span><span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">&quot;, 'for')&quot;</span><span class="token punctuation">;</span>
            statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="statement批处理"><a href="#statement批处理" class="header-anchor">#</a> statement批处理</h3> <p>在for循环中使用Statement的addBatch方法和executeBatch方法</p> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">batchUseStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Statement</span> statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;insert into batch_test values (&quot;</span><span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">&quot;, 'statement')&quot;</span><span class="token punctuation">;</span>
            statement<span class="token punctuation">.</span><span class="token function">addBatch</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        statement<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="preparedstatement批处理"><a href="#preparedstatement批处理" class="header-anchor">#</a> PreparedStatement批处理</h3> <p>在for循环中使用PreparedStatement的addBatch方法和executeBatch方法</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">batchUsePreparedStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;insert into batch_test values (?, 'prepareStatement')&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> preparedStatement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            preparedStatement<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            preparedStatement<span class="token punctuation">.</span><span class="token function">addBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        preparedStatement<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="事务"><a href="#事务" class="header-anchor">#</a> 事务</h2> <h3 id="介绍-2"><a href="#介绍-2" class="header-anchor">#</a> 介绍</h3> <p>数据库事务(transaction)：是一个数据库操作序列，它的所有操作要么全部执行成功，要么全部失败，是一个不可分割的工作单位。</p> <h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <ul><li>开启事务</li> <li>提交事务</li> <li>回滚事务</li></ul> <p>API：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//开启事务</span>
connection<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//提交事务</span>
connection<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//回滚事务</span>

connection<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>sql命令：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 开启事务</span>
<span class="token keyword">start</span> <span class="token keyword">transaction</span><span class="token punctuation">;</span>

<span class="token comment"># 提交事务</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>

<span class="token comment"># 回滚事务</span>
<span class="token keyword">rollback</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="转账事务示例"><a href="#转账事务示例" class="header-anchor">#</a> 转账事务示例</h3> <h3 id="特性"><a href="#特性" class="header-anchor">#</a> 特性</h3> <table><thead><tr><th style="text-align:center;">特性</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:center;">原子性(Atomicity)</td> <td style="text-align:left;">事务是一个不可分割的操作单元（数据库的操作），事务中的操作要么都成功，要么都失败。</td></tr> <tr><td style="text-align:center;">一致性(Consistency)</td> <td style="text-align:left;">事务必须使数据库从一个一致性状态到另一个一致性状态。（在转账案例中，一致性是指，在转账前后，钱的总金额是前后一致的，是不变的。）</td></tr> <tr><td style="text-align:center;">隔离性(Isolation)</td> <td style="text-align:left;">事务与事务之间是相互隔离的，互相不影响的。</td></tr> <tr><td style="text-align:center;">持久性(Durability)</td> <td style="text-align:left;">一个事务一旦生效，那么对数据库的改变是永久的，不可逆转的。意思就是提交事务后，就已经对数据库产生了变化，那么后续就无法回滚了。</td></tr></tbody></table> <h3 id="隔离级别"><a href="#隔离级别" class="header-anchor">#</a> 隔离级别</h3> <p>当数据库有多个事务执行时，可能会出现的问题</p> <table><thead><tr><th>问题</th> <th>描述</th></tr></thead> <tbody><tr><td>脏读</td> <td>一个事物读取到了另一个事物没有提交的数据。</td></tr> <tr><td>不可重复度</td> <td>在同一个事务中，读取同一个数据，前后读取的数据不一致。通常指的是，在一个事务中，读取到另一个事务已经提交的数据。</td></tr> <tr><td>幻读</td> <td>在同一个事务中，读取同一个表数据，前后读取的数量不一致。通常指的是，在一个事务中，读取到了另一个事务插入或删除的数据。</td></tr></tbody></table> <p>事务的隔离级别：</p> <p>一个参数，用于控制事务和事务之间的隔离级别。</p> <table><thead><tr><th style="text-align:left;">隔离级别</th> <th>描述</th></tr></thead> <tbody><tr><td style="text-align:left;">读未提交(read uncommitted)</td> <td>一个事务没有提交时，他所做的变更就能被别的事务看到。</td></tr> <tr><td style="text-align:left;">读已提交(read committed)</td> <td>一个事务提交之后，他所做的变更才会被其他事务看到。</td></tr> <tr><td style="text-align:left;">可重复读(repeatable read)</td> <td>一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的。在可重复读隔离级别下，未提交的变更对其他事务来说是不可见的。</td></tr> <tr><td style="text-align:left;">串行化(serializable)</td> <td>对于同一行记录，“写”会加写锁，“读&quot;会加读锁。当出现读写锁冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行。</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/skills/DSDB/HTTP&amp;Tomcat.html" class="prev">
        HTTP&amp;Tomcat
      </a></span> <span class="next"><a href="/blog/skills/DSDB/Map.html">
        Map
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.e95f8842.js" defer></script><script src="/blog/assets/js/3.08356745.js" defer></script><script src="/blog/assets/js/35.b5d4b577.js" defer></script>
  </body>
</html>
